# 16\. The OUTER JOIN Strength Reduction Optimization



 An OUTER JOIN (either a LEFT JOIN, a RIGHT JOIN, or a FULL JOIN)
 can sometimes be simplified. A LEFT or RIGHT JOIN can be converted
 into an ordinary (INNER) JOIN, or a FULL JOIN might be converted into
 either a LEFT or a RIGHT JOIN. This can happen if there are terms
 in the WHERE clause that guarantee the same result after simplification.
 For example, if any
 column in the right\-hand table of the LEFT JOIN must be non\-NULL
 in order for the WHERE clause to be true, then the LEFT JOIN is
 demoted to an ordinary JOIN.




 The theorem prover that determines whether a join can be simplified is
 imperfect. It sometimes returns a false negative. In other words,
 it sometimes fails to prove that reducing the strength of an OUTER JOIN
 is safe when in fact it is safe.
 For example, the prover does not know
 the [datetime() SQL function](lang_datefunc.html#dttm) will always return NULL if its first
 argument is NULL, and so it will not recognize that the LEFT JOIN
 in the following query could be strength\-reduced:




```
SELECT urls.url
  FROM urls
  LEFT JOIN
    (SELECT *
      FROM (SELECT url_id AS uid, max(retrieval_time) AS rtime
              FROM lookups GROUP BY 1 ORDER BY 1)
      WHERE uid IN (358341,358341,358341)
    ) recent
    ON u.source_seed_id = recent.xyz OR u.url_id = recent.xyz
 WHERE
     DATETIME(recent.rtime) > DATETIME('now', '-5 days');

```


 It is possible that future enhancements to the prover might enable it
 to recognize that NULL inputs to certain built\-in functions
 always result in a NULL answer. However, not all built\-in
 functions have that property (for example [coalesce()](lang_corefunc.html#coalesce)) and, of
 course, the prover will never be able to reason about
 [application\-defined SQL functions](appfunc.html).




