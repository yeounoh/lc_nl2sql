## 2\.3\. Pointer Leaks



The use of subtypes on pointers prevented pointer forgery using
pure SQL. But subtypes do nothing to prevent an attacker from reading
the values of pointers. In other words, subtypes on pointer values
prevent attacks using SQL statements like this:




```
SELECT snippet(x'6092310100000000') FROM t1 WHERE cx MATCH $pattern;

```


The BLOB argument to snippet() does not have the correct subtype, so the
snippet function ignores it, makes no changes to any data structures,
and harmlessly returns NULL.




But the use of subtypes does nothing to prevent the value of a
pointer from being read using SQL code like this:




```
SELECT hex(t1) FROM t1 WHERE cx MATCH $pattern;

```


What harm could come of that, you ask? The SQLite developers (including
this author) wondered the same thing. But then security researchers
pointed out that knowledge of pointers can help attackers to circumvent
address\-space randomization defenses. This is called a "pointer leak".
A pointer leak is not itself a vulnerability, but it can aid an attacker
in effectively exploiting other vulnerabilities.



