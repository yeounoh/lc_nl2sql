## 2\.2\. Preventing Forged Pointers



The first attempt at closing security gaps in pointer passing was to
prevent pointer values from being forged. This was accomplished by
having the sender attach a subtype to each pointer using
[sqlite3\_result\_subtype()](c3ref/result_subtype.html) and having the receiver verify that subtype
using [sqlite3\_value\_subtype()](c3ref/value_subtype.html) and reject pointers that had an incorrect
subtype. Since there is no way to attach a subtype to a result using
pure SQL, this prevents pointers from being forged using SQL. The only
way to send a pointer is to use C code. If an attacker can set a subtype,
then he is also able to forge a pointer without the help of SQLite.




Using subtypes to identify valid pointers prevented the WebSQL exploit.
But it turned out to be an incomplete solution.




