## 7\.2\. Integrity Check using the rtreecheck() SQL function


The scalar SQL function rtreecheck(R) or rtreecheck(S,R) runs an
integrity check on the rtree table named R contained within database S.
The function returns a human\-language description of any problems found,
or the string 'ok' if everything is ok. Running rtreecheck() on an R\*Tree
virtual table is similar to running [PRAGMA integrity\_check](pragma.html#pragma_integrity_check) on a
database.



Example: To verify that an R\*Tree named "demo\_index" is well\-formed
and internally consistent, run:




```
SELECT rtreecheck('demo_index');

```

The rtreecheck() function performs the following checks:



1. For each cell in the r\-tree structure (%\_node table), that:



	1. for each dimension, (coord1 \<\= coord2\).
	2. unless the cell is on the root node, that the cell is bounded
	 by the parent cell on the parent node.
	3. for leaf nodes, that there is an entry in the %\_rowid
	 table corresponding to the cell's rowid value that
	 points to the correct node.
	4. for cells on non\-leaf nodes, that there is an entry in the
	 %\_parent table mapping from the cell's child node to the
	 node that it resides on.
2. That there are the same number of entries in the %\_rowid table
as there are leaf cells in the r\-tree structure, and that there
is a leaf cell that corresponds to each entry in the %\_rowid table.
3. That there are the same number of entries in the %\_parent table
as there are non\-leaf cells in the r\-tree structure, and that
there is a non\-leaf cell that corresponds to each entry in the
%\_parent table.


*This page last modified on [2023\-02\-20 00:00:42](https://sqlite.org/docsrc/honeypot) UTC* 


