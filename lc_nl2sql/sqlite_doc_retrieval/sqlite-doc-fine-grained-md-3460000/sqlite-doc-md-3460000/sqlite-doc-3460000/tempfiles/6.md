## 2\.4\. Super\-Journal Files



The super\-journal file is used as part of the atomic commit
process when a single transaction makes changes to multiple
databases that have been added to a single [database connection](c3ref/sqlite3.html)
using the [ATTACH](lang_attach.html) statement. The super\-journal file is always
located in the same directory as the main database file
(the main database file is the database that is identified
in the original [sqlite3\_open()](c3ref/open.html), [sqlite3\_open16()](c3ref/open.html), or
[sqlite3\_open\_v2()](c3ref/open.html) call that created the [database connection](c3ref/sqlite3.html))
with a randomized suffix. The super\-journal file contains
the names of all of the various attached auxiliary databases
that were changed during the transaction. The multi\-database
transaction commits when the super\-journal file is deleted.
See the documentation titled
[Atomic Commit In SQLite](atomiccommit.html) for
additional detail.




Without the super\-journal, the transaction commit on a multi\-database
transaction would be atomic for each database individually, but it
would not be atomic across all databases. In other words, if the
commit were interrupted in the middle by a crash or power loss, then
the changes to one of the databases might complete while the changes
to another database might roll back. The super\-journal causes all
changes in all databases to either rollback or commit together.




The super\-journal file is only created for [COMMIT](lang_transaction.html) operations that
involve multiple database files where at least two of the databases 
meet all of the following requirements:



1. The database is modified by the transaction
2. The [PRAGMA synchronous](pragma.html#pragma_synchronous) setting is not OFF
3. The [PRAGMA journal\_mode](pragma.html#pragma_journal_mode) is not OFF, MEMORY, or WAL



This means that SQLite transactions are not atomic
across multiple database files on a power\-loss when the database 
files have synchronous turned off or when they are using journal 
modes of OFF, MEMORY, or WAL. For synchronous OFF and for
journal\_modes OFF and MEMORY, database will usually corrupt if
a transaction commit is interrupted by a power loss. For 
[WAL mode](wal.html), individual database files are updated atomically
across a power\-loss, but in the case of a multi\-file transactions,
some files might rollback while others roll forward after
power is restored.




