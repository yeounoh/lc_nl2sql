### The "preupdate" method


This method either registers a callback routine that is invoked just
before each row is modified by an UPDATE, INSERT, or DELETE statement,
or may perform certain operations related to the impending update.


To register or remove a preupdate callback, use this syntax:

> *dbcmd*  **preupdate  hook**  *?SCRIPT?*


When a preupdate callback is registered, then prior to each row modification,
the callback is run with these arguments:
* The keyword "INSERT", "UPDATE", or "DELETE", as appropriate
* The name of the database which is being changed
* The table that is being changed
* The original rowid of the row in the table being changed
* The new rowid (if any) of the row in the table being changed


The callback must not do anything that will modify the database connection
that invoked the preupdate hook such as running queries.


When the callback is executing, and only then, these preupdate operations
may be performed by use of the indicated syntax:

> *dbcmd*  **preupdate  count**  
> 
> *dbcmd*  **preupdate  depth**  
> 
> *dbcmd*  **preupdate  new**  *INDEX*  
> 
> *dbcmd*  **preupdate  old**  *INDEX*





The **count** submethod returns the number of columns in the row that is
being inserted, updated, or deleted.


The **depth** submethod returns the update nesting depth. This will be
0 for a direct insert, update, or delete operation;
1 for inserts, updates, or deletes invoked by top\-level triggers;
or higher values for changes resulting from trigger\-invoked triggers.


The **old** and **new** submethods return the selected original
or changed column value respectively of the row being updated.


Note that the Tcl interface (and underlying SQLite library) must have
been built with the preprocessor symbol SQLITE\_ENABLE\_PREUPDATE\_HOOK
defined for the **preupdate** method to be available.



