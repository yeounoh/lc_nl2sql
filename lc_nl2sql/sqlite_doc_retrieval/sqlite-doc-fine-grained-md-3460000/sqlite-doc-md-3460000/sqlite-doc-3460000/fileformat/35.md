## 2\.6\. Storage Of The SQL Database Schema


Page 1 of a database file is the root page of a table b\-tree that
holds a special table named "[sqlite\_schema](schematab.html)". This b\-tree is known
as the "schema table" since it stores the complete
database schema. The structure of the sqlite\_schema table is as
if it had been created using the following SQL:



> ```
> 
> CREATE TABLE sqlite_schema(
>   type text,
>   name text,
>   tbl_name text,
>   rootpage integer,
>   sql text
> );
> 
> ```


The sqlite\_schema table contains one row for each table, index, view,
and trigger (collectively "objects") in the database schema, except there
is no entry for the sqlite\_schema table itself. The sqlite\_schema table
contains entries for [internal schema objects](fileformat2.html#intschema) in addition to application\-
and programmer\-defined objects.




The sqlite\_schema.type column will be one
of the following text strings: 'table', 'index', 'view', or 'trigger'
according to the type of object defined. The 'table' string is used
for both ordinary and [virtual tables](vtab.html).


The sqlite\_schema.name column will hold the name of the object.
[UNIQUE](lang_createtable.html#uniqueconst) and [PRIMARY KEY](lang_createtable.html#primkeyconst) constraints on tables cause SQLite to create
[internal indexes](fileformat2.html#intschema) with names of the form "sqlite\_autoindex\_TABLE\_N"
where TABLE is replaced by the name of the table that contains the
constraint and N is an integer beginning with 1 and increasing by one
with each constraint seen in the table definition.
In a [WITHOUT ROWID](withoutrowid.html) table, there is no sqlite\_schema entry for the
PRIMARY KEY, but the "sqlite\_autoindex\_TABLE\_N" name is set aside
for the PRIMARY KEY as if the sqlite\_schema entry did exist. This
will affect the numbering of subsequent UNIQUE constraints.
The "sqlite\_autoindex\_TABLE\_N" name is never allocated for an
[INTEGER PRIMARY KEY](lang_createtable.html#rowid), either in rowid tables or WITHOUT ROWID tables.



The sqlite\_schema.tbl\_name column holds the name of a table or view
that the object is associated with. For a table or view, the
tbl\_name column is a copy of the name column. For an index, the tbl\_name
is the name of the table that is indexed. For a trigger, the tbl\_name
column stores the name of the table or view that causes the trigger 
to fire.


The sqlite\_schema.rootpage column stores the page number of the root
b\-tree page for tables and indexes. For rows that define views, triggers,
and virtual tables, the rootpage column is 0 or NULL.


The sqlite\_schema.sql column stores SQL text that describes the
object. This SQL text is a [CREATE TABLE](lang_createtable.html), [CREATE VIRTUAL TABLE](lang_createvtab.html),
[CREATE INDEX](lang_createindex.html),
[CREATE VIEW](lang_createview.html), or [CREATE TRIGGER](lang_createtrigger.html) statement that if evaluated against
the database file when it is the main database of a [database connection](c3ref/sqlite3.html)
would recreate the object. The text is usually a copy of the original
statement used to create the object but with normalizations applied so
that the text conforms to the following rules:



* The CREATE, TABLE, VIEW, TRIGGER, and INDEX keywords at the beginning
of the statement are converted to all upper case letters.
* The TEMP or TEMPORARY keyword is removed if it occurs after the 
initial CREATE keyword.
* Any database name qualifier that occurs prior to the name of the
object being created is removed.
* Leading spaces are removed.
* All spaces following the first two keywords are converted into a single
space.


The text in the sqlite\_schema.sql column is a copy of the original
CREATE statement text that created the object, except normalized as
described above and as modified by subsequent [ALTER TABLE](lang_altertable.html) statements.
The sqlite\_schema.sql is NULL for the [internal indexes](fileformat2.html#intschema) that are
automatically created by [UNIQUE](lang_createtable.html#uniqueconst) or [PRIMARY KEY](lang_createtable.html#primkeyconst) constraints.


