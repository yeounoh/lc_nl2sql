### 2\.6\.7\. The sqlite\_stat4 table


The sqlite\_stat4 is only created and is only used if SQLite is compiled
with [SQLITE\_ENABLE\_STAT4](compile.html#enable_stat4) and if the SQLite version number is
3\.8\.1 (2013\-10\-17\) or greater.
The sqlite\_stat4 table is neither read nor written by any
version of SQLite before 3\.8\.1\.
The sqlite\_stat4 table contains additional information
about the distribution of keys within an index or the distribution of
keys in the primary key of a [WITHOUT ROWID](withoutrowid.html) table.
The query planner can sometimes use the additional information in
the sqlite\_stat4 table to devise better and faster query algorithms.
The schema of the sqlite\_stat4 table is as follows:




> ```
> 
> CREATE TABLE sqlite_stat4(tbl,idx,nEq,nLt,nDLt,sample);
> 
> ```


There are typically between 10 to 40 entries in the sqlite\_stat4 table for
each index for which statistics are available, however these limits are
not hard bounds.
The meanings of the columns in the sqlite\_stat4 table are as follows:






| tbl: | The sqlite\_stat4\.tbl column holds name of the table that owns  the index that the row describes |
| --- | --- |
| idx: | The sqlite\_stat4\.idx column holds name of the index that the  row describes, or in the case of  an sqlite\_stat4 entry for a [WITHOUT ROWID](withoutrowid.html) table, the  name of the table itself. |
| sample: | The sqlite\_stat4\.sample column holds a BLOB  in the [record format](fileformat2.html#record_format) that encodes the indexed columns followed by  the rowid for a rowid table or by the columns of the primary key   for a WITHOUT ROWID table.  The sqlite\_stat4\.sample BLOB for the WITHOUT ROWID table itself   contains just the columns of the primary key.  Let the number of columns encoded by the sqlite\_stat4\.sample blob be N.  For indexes on an ordinary rowid table, N will be one more than the number   of columns indexed.  For indexes on WITHOUT ROWID tables, N will be the number of columns  indexed plus the number of columns in the primary key.  For a WITHOUT ROWID table, N will be the number of columns in the  primary key. |
| nEq: | The sqlite\_stat4\.nEq column holds a list of N integers where   the K\-th integer is the approximate number of entries in the index  whose left\-most K columns exactly match the K left\-most columns  of the sample. |
| nLt: | The sqlite\_stat4\.nLt column holds a list of N integers where  the K\-th integer is the approximate number of entries in the  index whose K left\-most columns are collectively less than the   K left\-most columns of the sample. |
| nDLt: | The sqlite\_stat4\.nDLt column holds a list of N integers where  the K\-th integer is the approximate  number of entries in the index that are distinct in the first K columns and  where the left\-most K columns are collectively less than the left\-most  K columns of the sample. |



The sqlite\_stat4 is a generalization of the sqlite\_stat3 table. The
sqlite\_stat3 table provides information about the left\-most column of an
index whereas the sqlite\_stat4 table provides information about all columns
of the index.



There can be an arbitrary number of sqlite\_stat4 entries per index.
The [ANALYZE](lang_analyze.html) command will typically generate sqlite\_stat4 tables
that contain between 10 and 40 samples that are distributed across
the key space and with large nEq values.



In a well\-formed sqlite\_stat4 table, the samples for any single
index must appear in the same order that they occur in the index. 
In other words, if entry S1 is earlier in the index b\-tree than 
entry S2, then in the sqlite\_stat4 table, sample S1 must have a
smaller rowid than sample S2\.




