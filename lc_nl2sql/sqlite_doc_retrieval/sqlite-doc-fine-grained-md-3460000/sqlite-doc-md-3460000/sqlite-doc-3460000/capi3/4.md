#### 2\.1 Opening and closing a database



> ```
> 
>    typedef struct sqlite3 sqlite3;
>    int sqlite3_open(const char*, sqlite3**);
>    int sqlite3_open16(const void*, sqlite3**);
>    int sqlite3_close(sqlite3*);
>    const char *sqlite3_errmsg(sqlite3*);
>    const void *sqlite3_errmsg16(sqlite3*);
>    int sqlite3_errcode(sqlite3*);
> 
> ```



The sqlite3\_open() routine returns an integer error code rather than
a pointer to the sqlite3 structure as the version 2 interface did.
The difference between sqlite3\_open()
and sqlite3\_open16() is that sqlite3\_open16() takes UTF\-16 (in host native
byte order) for the name of the database file. If a new database file
needs to be created, then sqlite3\_open16() sets the internal text
representation to UTF\-16 whereas sqlite3\_open() sets the text
representation to UTF\-8\.




The opening and/or creating of the database file is deferred until the
file is actually needed. This allows options and parameters, such
as the native text representation and default page size, to be
set using PRAGMA statements.




The sqlite3\_errcode() routine returns a result code for the most
recent major API call. sqlite3\_errmsg() returns an English\-language
text error message for the most recent error. The error message is
represented in UTF\-8 and will be ephemeral \- it could disappear on
the next call to any SQLite API function. sqlite3\_errmsg16() works like
sqlite3\_errmsg() except that it returns the error message represented
as UTF\-16 in host native byte order.




The error codes for SQLite version 3 are unchanged from version 2\.
They are as follows:




> ```
> 
> #define SQLITE_OK           0   /* Successful result */
> #define SQLITE_ERROR        1   /* SQL error or missing database */
> #define SQLITE_INTERNAL     2   /* An internal logic error in SQLite */
> #define SQLITE_PERM         3   /* Access permission denied */
> #define SQLITE_ABORT        4   /* Callback routine requested an abort */
> #define SQLITE_BUSY         5   /* The database file is locked */
> #define SQLITE_LOCKED       6   /* A table in the database is locked */
> #define SQLITE_NOMEM        7   /* A malloc() failed */
> #define SQLITE_READONLY     8   /* Attempt to write a readonly database */
> #define SQLITE_INTERRUPT    9   /* Operation terminated by sqlite_interrupt() */
> #define SQLITE_IOERR       10   /* Some kind of disk I/O error occurred */
> #define SQLITE_CORRUPT     11   /* The database disk image is malformed */
> #define SQLITE_NOTFOUND    12   /* (Internal Only) Table or record not found */
> #define SQLITE_FULL        13   /* Insertion failed because database is full */
> #define SQLITE_CANTOPEN    14   /* Unable to open the database file */
> #define SQLITE_PROTOCOL    15   /* Database lock protocol error */
> #define SQLITE_EMPTY       16   /* (Internal Only) Database table is empty */
> #define SQLITE_SCHEMA      17   /* The database schema changed */
> #define SQLITE_TOOBIG      18   /* Too much data for one row of a table */
> #define SQLITE_CONSTRAINT  19   /* Abort due to contraint violation */
> #define SQLITE_MISMATCH    20   /* Data type mismatch */
> #define SQLITE_MISUSE      21   /* Library used incorrectly */
> #define SQLITE_NOLFS       22   /* Uses OS features not supported on host */
> #define SQLITE_AUTH        23   /* Authorization denied */
> #define SQLITE_ROW         100  /* sqlite_step() has another row ready */
> #define SQLITE_DONE        101  /* sqlite_step() has finished executing */
> 
> ```


