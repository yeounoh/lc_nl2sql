### 3\.1\.7\. Memory allocator overlays


An application can insert layers or "overlays" in between the
SQLite core and the underlying memory allocator.
For example, the [out\-of\-memory test logic](#oomtesting)
for SQLite uses an overlay that can simulate memory allocation
failures.


An overlay can be created by using the



> ```
> 
> [sqlite3_config](c3ref/config.html)([SQLITE_CONFIG_GETMALLOC](c3ref/c_config_covering_index_scan.html#sqliteconfiggetmalloc), pOldMem);
> 
> ```


interface to obtain pointers to the existing memory allocator.
The existing allocator is saved by the overlay and is used as
a fallback to do real memory allocation. Then the overlay is
inserted in place of the existing memory allocator using
the [sqlite3\_config](c3ref/config.html)([SQLITE\_CONFIG\_MALLOC](c3ref/c_config_covering_index_scan.html#sqliteconfigmalloc),...) as described
[above](#appalloc).




