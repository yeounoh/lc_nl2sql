## 3\.4\.  Memory status


By default, SQLite keeps statistics on its memory usage. These
statistics are useful in helping to determine how much memory an
application really needs. The statistics can also be used in
high\-reliability system to determine
if the memory usage is coming close to or exceeding the limits 
of the [Robson proof](malloc.html#nofrag) and hence that the memory allocation subsystem is 
liable to breakdown.


Most memory statistics are global, and therefore the tracking of
statistics must be serialized with a mutex. Statistics are turned 
on by default, but an option exists to disable them. By disabling 
memory statistics,
SQLite avoids entering and leaving a mutex on each memory allocation
and deallocation. That savings can be noticeable on systems where
mutex operations are expensive. To disable memory statistics, the
following interface is used at start\-time:



> ```
> 
> [sqlite3_config](c3ref/config.html)([SQLITE_CONFIG_MEMSTATUS](c3ref/c_config_covering_index_scan.html#sqliteconfigmemstatus), onoff);
> 
> ```


The "onoff" parameter is true to enable the tracking of memory
statistics and false to disable statistics tracking.


Assuming statistics are enabled, the following routine can be used
to access them:



> ```
> 
> [sqlite3_status](c3ref/status.html)([verb](c3ref/c_status_malloc_count.html#sqlitestatusmemoryused), &current, &highwater, resetflag);
> 
> ```


The "verb" argument determines what statistic is accessed.
There are [various verbs](c3ref/c_status_malloc_count.html#sqlitestatusmemoryused) defined. The
list is expected to grow as the [sqlite3\_status()](c3ref/status.html) interface matures.
The current value the selected parameter is written into integer 
"current" and the highest historical value
is written into integer "highwater". If resetflag is true, then
the high\-water mark is reset down to the current value after the call
returns.


A different interface is used to find statistics associated with a
single [database connection](c3ref/sqlite3.html):



> ```
> 
> [sqlite3_db_status](c3ref/db_status.html)(db, [verb](c3ref/c_dbstatus_options.html#sqlitedbstatuslookasideused), &current, &highwater, resetflag);
> 
> ```


This interface is similar except that it takes a pointer to
a [database connection](c3ref/sqlite3.html) as its first argument and returns statistics about
that one object rather than about the entire SQLite library.
The [sqlite3\_db\_status()](c3ref/db_status.html) interface currently only recognizes a
single verb [SQLITE\_DBSTATUS\_LOOKASIDE\_USED](c3ref/c_dbstatus_options.html#sqlitedbstatuslookasideused), though additional verbs
may be added in the future.


The per\-connection statistics do not use global variables and hence
do not require mutexes to update or access. Consequently the
per\-connection statistics continue to function even if
[SQLITE\_CONFIG\_MEMSTATUS](c3ref/c_config_covering_index_scan.html#sqliteconfigmemstatus) is turned off.



