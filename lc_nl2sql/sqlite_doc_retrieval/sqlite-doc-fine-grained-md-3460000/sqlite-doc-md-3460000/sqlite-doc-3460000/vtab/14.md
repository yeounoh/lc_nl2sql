## 2\.2\. The xConnect Method



```
int (*xConnect)(sqlite3*, void *pAux,
             int argc, char *const*argv,
             sqlite3_vtab **ppVTab,
             char **pzErr);

```

The xConnect method is very similar to [xCreate](vtab.html#xcreate). 
It has the same parameters and constructs a new [sqlite3\_vtab](c3ref/vtab.html) structure 
just like xCreate. 
And it must also call [sqlite3\_declare\_vtab()](c3ref/declare_vtab.html) like xCreate. It
should also make all of the same [sqlite3\_vtab\_config()](c3ref/vtab_config.html) calls as
xCreate.



The difference is that xConnect is called to establish a new 
connection to an existing virtual table whereas xCreate is called 
to create a new virtual table from scratch.



The xCreate and xConnect methods are only different when the
virtual table has some kind of backing store that must be initialized 
the first time the virtual table is created. The xCreate method creates 
and initializes the backing store. The xConnect method just connects 
to an existing backing store. When xCreate and xConnect are the same,
the table is an [eponymous virtual table](vtab.html#epovtab).



As an example, consider a virtual table implementation that 
provides read\-only access to existing comma\-separated\-value (CSV)
files on disk. There is no backing store that needs to be created 
or initialized for such a virtual table (since the CSV files already 
exist on disk) so the xCreate and xConnect methods will be identical 
for that module.



Another example is a virtual table that implements a full\-text index. 
The xCreate method must create and initialize data structures to hold 
the dictionary and posting lists for that index. The xConnect method,
on the other hand, only has to locate and use an existing dictionary 
and posting lists that were created by a prior xCreate call.



The xConnect method must return [SQLITE\_OK](rescode.html#ok) if it is successful 
in creating the new virtual table, or [SQLITE\_ERROR](rescode.html#error) if it is not 
successful. If not successful, the [sqlite3\_vtab](c3ref/vtab.html) structure must not be 
allocated. An error message may optionally be returned in \*pzErr if 
unsuccessful. 
Space to hold the error message string must be allocated using
an SQLite memory allocation function like 
[sqlite3\_malloc()](c3ref/free.html) or [sqlite3\_mprintf()](c3ref/mprintf.html) as the SQLite core will
attempt to free the space using [sqlite3\_free()](c3ref/free.html) after the error has
been reported up to the application.



The xConnect method is required for every virtual table implementation, 
though the [xCreate](vtab.html#xcreate) and xConnect pointers of the [sqlite3\_module](c3ref/module.html) object
may point to the same function if the virtual table does not need to
initialize backing store.




