#define SQLITE_INDEX_SCAN_UNIQUE           1  /* Scan visits at most 1 row */

```

Use the [sqlite3\_vtab\_collation()](c3ref/vtab_collation.html) interface to find the name of
the [collating sequence](datatype3.html#collation) that should be used when evaluating the i\-th
constraint:




```
const char *sqlite3_vtab_collation(sqlite3_index_info*, int i);

```

The SQLite core calls the xBestIndex method when it is compiling a query
that involves a virtual table. In other words, SQLite calls this method 
when it is running [sqlite3\_prepare()](c3ref/prepare.html) or the equivalent. 
By calling this method, the 
SQLite core is saying to the virtual table that it needs to access 
some subset of the rows in the virtual table and it wants to know the
most efficient way to do that access. The xBestIndex method replies 
with information that the SQLite core can then use to conduct an 
efficient search of the virtual table.



While compiling a single SQL query, the SQLite core might call 
xBestIndex multiple times with different settings in [sqlite3\_index\_info](c3ref/index_info.html).
The SQLite core will then select the combination that appears to 
give the best performance.



Before calling this method, the SQLite core initializes an instance 
of the [sqlite3\_index\_info](c3ref/index_info.html) structure with information about the
query that it is currently trying to process. This information 
derives mainly from the WHERE clause and ORDER BY or GROUP BY clauses 
of the query, but also from any ON or USING clauses if the query is a 
join. The information that the SQLite core provides to the xBestIndex 
method is held in the part of the structure that is marked as "Inputs". 
The "Outputs" section is initialized to zero.



The information in the [sqlite3\_index\_info](c3ref/index_info.html) structure is ephemeral
and may be overwritten or deallocated as soon as the xBestIndex method
returns. If the xBestIndex method needs to remember any part of the
[sqlite3\_index\_info](c3ref/index_info.html) structure, it should make a copy. Care must be
take to store the copy in a place where it will be deallocated, such
as in the idxStr field with needToFreeIdxStr set to 1\.



Note that xBestIndex will always be called before [xFilter](vtab.html#xfilter), since
the idxNum and idxStr outputs from xBestIndex are required inputs to
xFilter. However, there is no guarantee that xFilter will be called
following a successful xBestIndex.



The xBestIndex method is required for every virtual table implementation.



