### 2\.2\.1\. Multiple copies of SQLite linked into the same application


As pointed out in the previous paragraph, SQLite takes steps to work
around the quirks of POSIX advisory locking. Part of that work\-around involves
keeping a global list (mutex protected) of open SQLite database files.
But, if multiple copies of SQLite are linked into the same application,
then there will be multiple instances of this global list.
Database connections opened using one copy of the SQLite library
will be unaware of database connections opened using the other copy,
and will be unable to work around the POSIX advisory locking quirks.
A close() operation on one connection might unknowingly 
clear the locks on a different database connection, leading to database
corruption.


The scenario above sounds far\-fetched.
But the SQLite developers are aware of at 
least one commercial product that was released
with exactly this bug. The vendor came to the SQLite developers seeking
help in tracking down some infrequent database corruption issues they were
seeing on Linux and Mac. The problem was eventually traced to the
fact that the application was linking against two separate copies of SQLite.
The solution was to change the application build procedures to link against
just one copy of SQLite instead of two.


