## 2\.1\. Queries



To query the geopoly table using an indexed geospatial search, 
use one of the functions geopoly\_overlap()
or geopoly\_within() as a boolean function in the WHERE clause,
with the "\_shape" column as the first argument to the function.
For example:




```
SELECT * FROM newtab WHERE geopoly_overlap(_shape, $query_polygon);

```


The previous example will return every row for which the \_shape
overlaps the polygon in the $query\_polygon parameter. The
geopoly\_within() function works similarly, but only returns rows for
which the \_shape is completely contained within $query\_polygon.




Queries (and also DELETE and UPDATE statements) in which the WHERE
clause contains a bare geopoly\_overlap() or geopoly\_within() function
make use of the underlying R\*Tree data structures for a fast lookup that
only has to examine a subset of the rows in the table. The number of
rows examines depends, of course, on the size of the $query\_polygon.
Large $query\_polygons will normally need to look at more rows than small
ones.




Queries against the rowid of a geopoly table are also very quick, even
for tables with a vast number of rows.
However, none of the auxiliary data columns are indexes, and so queries
against the auxiliary data columns will involve a full table scan.



