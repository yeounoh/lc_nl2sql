# 4\. Auxiliary Functions \- Snippet, Offsets and Matchinfo



 The FTS3 and FTS4 modules provide three special SQL scalar functions that may be useful
 to the developers of full\-text query systems: "snippet", "offsets" and
 "matchinfo". The purpose of the "snippet" and "offsets" functions is to allow
 the user to identify the location of queried terms in the returned documents.
 The "matchinfo" function provides the user with metrics that may be useful
 for filtering or sorting query results according to relevance.




 The first argument to all three special SQL scalar functions
 must be the [FTS hidden column](fts3.html#hiddencol) of the FTS table that the function is
 applied to. The [FTS hidden column](fts3.html#hiddencol) is an automatically\-generated column found on
 all FTS tables that has the same name as the FTS table itself.
 For example, given an FTS table named "mail":




```
SELECT offsets(mail) FROM mail WHERE mail MATCH <full-text query expression>;
SELECT snippet(mail) FROM mail WHERE mail MATCH <full-text query expression>;
SELECT matchinfo(mail) FROM mail WHERE mail MATCH <full-text query expression>;

```


 The three auxiliary functions are only useful within a SELECT statement that
 uses the FTS table's full\-text index. If used within a SELECT that uses
 the "query by rowid" or "linear scan" strategies, then the snippet and
 offsets both return an empty string, and the matchinfo function returns
 a blob value zero bytes in size.





 All three auxiliary functions extract a set of "matchable phrases" from
 the FTS query expression to work with. The set of matchable phrases for
 a given query consists of all phrases (including unquoted tokens and
 token prefixes) in the expression except those that are prefixed with
 a unary "\-" operator (standard syntax) or are part of a sub\-expression
 that is used as the right\-hand operand of a NOT operator.




 With the following provisos, each series of tokens in the FTS table that
 matches one of the matchable phrases in the query expression is known as a
 "phrase match":



1. If a matchable phrase is part of a series of phrases connected by
 NEAR operators in the FTS query expression, then each phrase match
 must be sufficiently close to other phrase matches of the relevant
 types to satisfy the NEAR condition.
2. If the matchable phrase in the FTS query is restricted to matching
 data in a specified FTS table column, then only phrase matches that
 occur within that column are considered.



