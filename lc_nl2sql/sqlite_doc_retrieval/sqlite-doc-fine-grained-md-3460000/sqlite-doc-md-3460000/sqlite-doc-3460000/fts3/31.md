## 7\.5\. The "automerge\=N" command



 The "automerge\=N" command (where N is an integer between 0 and 15,
 inclusive) is used to configure an FTS3/4 tables "automerge" parameter,
 which controls automatic incremental inverted index merging. The default
 automerge value for new tables is 0, meaning that automatic incremental
 merging is completely disabled. If the value of the automerge parameter
 is modified using the "automerge\=N" command, the new parameter value is
 stored persistently in the database and is used by all subsequently
 established database connections.




 Setting the automerge parameter to a non\-zero value enables automatic
 incremental merging. This causes SQLite to do a small amount of inverted
 index merging after every INSERT operation. The amount of merging
 performed is designed so that the FTS3/4 table never reaches a point
 where it has 16 segments at the same level and hence has to do a large
 merge in order to complete an insert. In other words, automatic
 incremental merging is designed to prevent spiky INSERT performance.




 The downside of automatic incremental merging is that it makes
 every INSERT, UPDATE, and DELETE operation on an FTS3/4 table run
 a little slower, since extra time must be used to do the incremental
 merge. For maximum performance, it is recommended that applications
 disable automatic incremental merge and instead use the
 ["merge" command](fts3.html#*fts4mergecmd) in an idle process to keep the inverted indices
 well merged. But if the structure of an application does not easily
 allow for idle processes, the use of automatic incremental merge is
 a very reasonable fallback solution.




 The actual value of the automerge parameter determines the number of
 index segments merged simultaneously by an automatic inverted index
 merge. If the value is set to N, the system waits until there are at
 least N segments on a single level before beginning to incrementally
 merge them. Setting a lower value of N causes segments to be merged more
 quickly, which may speed up full\-text queries and, if the workload
 contains UPDATE or DELETE operations as well as INSERTs, reduce the space
 on disk consumed by the full\-text index. However, it also increases the
 amount of data written to disk.




 For general use in cases where the workload contains few UPDATE or DELETE
 operations, a good choice for automerge is 8\. If the workload contains
 many UPDATE or DELETE commands,
 or if query speed is a concern, it may be advantageous to reduce automerge
 to 2\.




 For reasons of backwards compatibility, the "automerge\=1" command sets
 the automerge parameter to 8, not 1 (a value of 1 would make no sense
 anyway, as merging data from a single segment is a no\-op).





