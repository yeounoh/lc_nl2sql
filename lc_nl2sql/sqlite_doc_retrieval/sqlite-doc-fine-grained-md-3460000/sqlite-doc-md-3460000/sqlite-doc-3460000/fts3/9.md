# 3\. Full\-text Index Queries



 The most useful thing about FTS tables is the queries that may be
 performed using the built\-in full\-text index. Full\-text queries are
 performed by specifying a clause of the form
 "\<column\> MATCH \<full\-text query expression\>" as part of the WHERE
 clause of a SELECT statement that reads data from an FTS table.
 [Simple FTS queries](fts3.html#simple_fts_queries) that return all documents that
 contain a given term are described above. In that discussion the right\-hand
 operand of the MATCH operator was assumed to be a string consisting of a
 single term. This section describes the more complex query types supported
 by FTS tables, and how they may be utilized by specifying a more
 complex query expression as the right\-hand operand of a MATCH operator.




 FTS tables support three basic query types:



* **Token or token prefix queries**.
 An FTS table may be queried for all documents that contain a specified
 term (the [simple case](fts3.html#simple_fts_queries) described above), or for
 all documents that contain a term with a specified prefix. As we have
 seen, the query expression for a specific term is simply the term itself.
 The query expression used to search for a term prefix is the prefix
 itself with a '\*' character appended to it. For example:



```
-- Virtual table declaration
CREATE VIRTUAL TABLE docs USING fts3(title, body);

-- Query for all documents containing the term "linux":
SELECT * FROM docs WHERE docs MATCH 'linux';

-- Query for all documents containing a term with the prefix "lin". This will match
-- all documents that contain "linux", but also those that contain terms "linear",
--"linker", "linguistic" and so on.
SELECT * FROM docs WHERE docs MATCH 'lin*';

```

* Normally, a token or token prefix query is matched against the FTS table
 column specified as the left\-hand side of the MATCH operator. Or, if the
 special column with the same name as the FTS table itself is specified,
 against all columns. This may be overridden by specifying a column\-name
 followed by a ":" character before a basic term query. There may be space
 between the ":" and the term to query for, but not between the column\-name
 and the ":" character. For example:



```
-- Query the database for documents for which the term "linux" appears in
-- the document title, and the term "problems" appears in either the title
-- or body of the document.
SELECT * FROM docs WHERE docs MATCH 'title:linux problems';

-- Query the database for documents for which the term "linux" appears in
-- the document title, and the term "driver" appears in the body of the document
-- ("driver" may also appear in the title, but this alone will not satisfy the
-- query criteria).
SELECT * FROM docs WHERE body MATCH 'title:linux driver';

```

* If the FTS table is an FTS4 table (not FTS3\), a token may also be prefixed
 with a "^" character. In this case, in order to match the token must
 appear as the very first token in any column of the matching row. Examples:



```
-- All documents for which "linux" is the first token of at least one
-- column.
SELECT * FROM docs WHERE docs MATCH '^linux';

-- All documents for which the first token in column "title" begins with "lin".
SELECT * FROM docs WHERE body MATCH 'title: ^lin*';

```


* **Phrase queries**.
 A phrase query is a query that retrieves all documents that contain a
 nominated set of terms or term prefixes in a specified order with no
 intervening tokens. Phrase queries are specified by enclosing a space
 separated sequence of terms or term prefixes in double quotes (").
 For example:



```
-- Query for all documents that contain the phrase "linux applications".
SELECT * FROM docs WHERE docs MATCH '"linux applications"';

-- Query for all documents that contain a phrase that matches "lin* app*". As well as
-- "linux applications", this will match common phrases such as "linoleum appliances"
-- or "link apprentice".
SELECT * FROM docs WHERE docs MATCH '"lin* app*"';

```


* **NEAR queries**.
 A NEAR query is a query that returns documents that contain a two or
 more nominated terms or phrases within a specified proximity of each
 other (by default with 10 or less intervening terms). A NEAR query is
 specified by putting the keyword "NEAR" between two phrase, token or
 token prefix queries. To specify a proximity other than the default,
 an operator of the form "NEAR/*\<N\>*" may be used, where
 *\<N\>* is the maximum number of intervening terms allowed.
 For example:



```
-- Virtual table declaration.
CREATE VIRTUAL TABLE docs USING fts4();

-- Virtual table data.
INSERT INTO docs VALUES('SQLite is an ACID compliant embedded relational database management system');

-- Search for a document that contains the terms "sqlite" and "database" with
-- not more than 10 intervening terms. This matches the only document in
-- table docs (since there are only six terms between "SQLite" and "database"
-- in the document).
SELECT * FROM docs WHERE docs MATCH 'sqlite NEAR database';

-- Search for a document that contains the terms "sqlite" and "database" with
-- not more than 6 intervening terms. This also matches the only document in
-- table docs. Note that the order in which the terms appear in the document
-- does not have to be the same as the order in which they appear in the query.
SELECT * FROM docs WHERE docs MATCH 'database NEAR/6 sqlite';

-- Search for a document that contains the terms "sqlite" and "database" with
-- not more than 5 intervening terms. This query matches no documents.
SELECT * FROM docs WHERE docs MATCH 'database NEAR/5 sqlite';

-- Search for a document that contains the phrase "ACID compliant" and the term
-- "database" with not more than 2 terms separating the two. This matches the
-- document stored in table docs.
SELECT * FROM docs WHERE docs MATCH 'database NEAR/2 "ACID compliant"';

-- Search for a document that contains the phrase "ACID compliant" and the term
-- "sqlite" with not more than 2 terms separating the two. This also matches
-- the only document stored in table docs.
SELECT * FROM docs WHERE docs MATCH '"ACID compliant" NEAR/2 sqlite';

```

* More than one NEAR operator may appear in a single query. In this case each
 pair of terms or phrases separated by a NEAR operator must appear within the
 specified proximity of each other in the document. Using the same table and
 data as in the block of examples above:



```
-- The following query selects documents that contains an instance of the term 
-- "sqlite" separated by two or fewer terms from an instance of the term "acid",
-- which is in turn separated by two or fewer terms from an instance of the term
-- "relational".
SELECT * FROM docs WHERE docs MATCH 'sqlite NEAR/2 acid NEAR/2 relational';

-- This query matches no documents. There is an instance of the term "sqlite" with
-- sufficient proximity to an instance of "acid" but it is not sufficiently close
-- to an instance of the term "relational".
SELECT * FROM docs WHERE docs MATCH 'acid NEAR/2 sqlite NEAR/2 relational';

```


 Phrase and NEAR queries may not span multiple columns within a row.




 The three basic query types described above may be used to query the full\-text
 index for the set of documents that match the specified criteria. Using the
 FTS query expression language it is possible to perform various set
 operations on the results of basic queries. There are currently three
 supported operations:



* The AND operator determines the **intersection** of two sets of documents.
* The OR operator calculates the **union** of two sets of documents.
* The NOT operator (or, if using the standard syntax, a unary "\-" operator)
 may be used to compute the **relative complement** of one set of
 documents with respect to another.



 The FTS modules may be compiled to use one of two slightly different versions
 of the full\-text query syntax, the "standard" query syntax and the "enhanced"
 query syntax. The basic term, term\-prefix, phrase and NEAR queries described
 above are the same in both versions of the syntax. The way in which set
 operations are specified is slightly different. The following two sub\-sections
 describe the part of the two query syntaxes that pertains to set operations.
 Refer to the description of how to [compile fts](fts3.html#compiling_and_enabling_fts3_and_fts4) for compilation notes.




