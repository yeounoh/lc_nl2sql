## 2\.2\. UPDATE FROM


The UPDATE\-FROM idea is an extension to SQL that allows an UPDATE
statement to be driven by other tables in the database. 
The "target" table is the specific table that is being
updated. With UPDATE\-FROM you can join the target table
against other tables in the database in order to help compute which
rows need updating and what the new values should be on those rows.
UPDATE\-FROM is supported beginning in SQLite version 3\.33\.0
(2020\-08\-14\).



Other relation database engines also implement UPDATE\-FROM, but
because the construct is not part of the SQL standards, each product
implements UPDATE\-FROM differently. The SQLite implementation strives
to be compatible with PostgreSQL. The SQL Server and MySQL implementations
of the same idea work a little differently.



As an example of how UPDATE\-FROM can be useful, 
suppose you have a point\-of\-sale application that accumulates
purchases in the SALES table. At the end of the day, you want to adjust
the INVENTORY table according to the daily sales. To do this, you can
run an UPDATE against the INVENTORY table that adjusts the quantity by
the aggregated sales for the day. The statement would look like this:




```
UPDATE inventory
   SET quantity = quantity - daily.amt
  FROM (SELECT sum(quantity) AS amt, itemId FROM sales GROUP BY 2) AS daily
 WHERE inventory.itemId = daily.itemId;

```


The subquery in the FROM clause computes the amount by which the
inventory should be reduced for each itemId. That subquery is joined
against the inventory table and the quantity of each affected inventory
row is reduced by the appropriate amount.




The target table is not included in the FROM clause, unless the intent
is to do a self\-join against the target table. In the event of a self\-join,
the table in the FROM clause must be aliased to a different name
than the target table.




If the join between the target table and the FROM clause results in
multiple output rows for the same target table row, then only one of
those output rows is used for updating the target table. The output
row selected is arbitrary and might change from one release of SQLite
to the next, or from one run to the next.



