# 2\. The VFS In Relation To The Rest Of SQLite



![](images/vfs1.gif)


The internal organization of the SQLite library can be viewed as the
stack of modules shown to the right.
The Tokenizer, Parser, and Code Generator components are used to
process SQL statements and convert them into executable programs 
in a virtual machine language or byte code.
Roughly speaking, these top three layers implement
[sqlite3\_prepare\_v2()](c3ref/prepare.html). The byte code generated by the top three
layers is a [prepared statement](c3ref/stmt.html).
The Virtual Machine module is responsible for running the SQL statement 
byte code. The B\-Tree module organizes a database file into multiple 
key/value stores with ordered keys and logarithmic performance. 
The Pager module is responsible for loading pages of the database
file into memory, for implementing and controlling transactions, and 
for creating and maintaining the journal files that prevent database 
corruption following a crash or power failure. 
The OS Interface is a thin abstraction that provides a common set of 
routines for adapting SQLite to run on different operating systems.
Roughly speaking, the bottom four layers implement
[sqlite3\_step()](c3ref/step.html).




This article is about the bottom layer.



The OS Interface \- also called the "VFS" \- is what makes SQLite 
portable across operating systems. Whenever any of the other modules
in SQLite needs to communicate with the operating
system, they invoke methods in the VFS. The VFS then invokes the
operating\-specific code needed to satisfy the request.
Hence, porting SQLite to a new
operating system is simply a matter of writing a new OS interface layer
or "VFS".


