# 4\. VFS Implementations



A new VFS is implemented by subclassing three objects:



* [sqlite3\_vfs](c3ref/vfs.html)
* [sqlite3\_io\_methods](c3ref/io_methods.html)
* [sqlite3\_file](c3ref/file.html)



An [sqlite3\_vfs](c3ref/vfs.html) object defines the name of the VFS and the core
methods that implement the interface to the operating system, such
as checking for existence of files, deleting files, creating files
and opening and for reading and/or writing, converting filenames
into their canonical form. The [sqlite3\_vfs](c3ref/vfs.html) object also contains
methods for obtaining randomness from the operating system, for
suspending a process (sleeping) and for finding the current date and
time.




The [sqlite3\_file](c3ref/file.html) object represents an open file.
The xOpen method of [sqlite3\_vfs](c3ref/vfs.html) constructs an [sqlite3\_file](c3ref/file.html)
object when the file is opened. The [sqlite3\_file](c3ref/file.html) keeps track
of the state of the file while it is opened.




The [sqlite3\_io\_methods](c3ref/io_methods.html) object holds the methods used to interact
with an open file. Each [sqlite3\_file](c3ref/file.html) contains a pointer to 
an [sqlite3\_io\_methods](c3ref/io_methods.html) object that is appropriate for the file it
represents. The [sqlite3\_io\_methods](c3ref/io_methods.html) object contains methods to do
things such as read and write from the file, to truncate the file,
to flush any changes to persistent storage, to find the size of the
file, to lock and unlock the file, and to close file and destroy
the [sqlite3\_file](c3ref/file.html) object.




Writing the code for a new VFS involves constructing a subclass for
the [sqlite3\_vfs](c3ref/vfs.html) object and then registering that VFS object using
a call to [sqlite3\_vfs\_register()](c3ref/vfs_find.html). The VFS implementation also
provides subclasses for [sqlite3\_file](c3ref/file.html) and [sqlite3\_io\_methods](c3ref/io_methods.html) but
those objects are not registered directly with SQLite. Instead, the
[sqlite3\_file](c3ref/file.html) object is returned from the xOpen method of
[sqlite3\_vfs](c3ref/vfs.html) and the [sqlite3\_file](c3ref/file.html) object points to an instance
of the [sqlite3\_io\_methods](c3ref/io_methods.html) object.



*This page last modified on [2024\-02\-22 15:53:45](https://sqlite.org/docsrc/honeypot) UTC* 


