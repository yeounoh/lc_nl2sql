#### 2\.3 Deleting A Virtual Machine



Every virtual machine that **sqlite\_compile** creates should
eventually be handed to **sqlite\_finalize**. The sqlite\_finalize()
procedure deallocates the memory and other resources that the virtual
machine uses. Failure to call sqlite\_finalize() will result in 
resource leaks in your program.




The **sqlite\_finalize** routine also returns the result code
that indicates success or failure of the SQL operation that the
virtual machine carried out.
The value returned by sqlite\_finalize() will be the same as would
have been returned had the same SQL been executed by **sqlite\_exec**.
The error message returned will also be the same.




It is acceptable to call **sqlite\_finalize** on a virtual machine
before **sqlite\_step** has returned SQLITE\_DONE. Doing so has
the effect of interrupting the operation in progress. Partially completed
changes will be rolled back and the database will be restored to its
original state (unless an alternative recovery algorithm is selected using
an ON CONFLICT clause in the SQL being executed.) The effect is the
same as if a callback function of **sqlite\_exec** had returned
non\-zero.




It is also acceptable to call **sqlite\_finalize** on a virtual machine
that has never been passed to **sqlite\_step** even once.



