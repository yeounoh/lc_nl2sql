#### 2\.1 Compiling An SQL Statement Into A Virtual Machine



The **sqlite\_compile** "compiles" a single SQL statement (specified
by the second parameter) and generates a virtual machine that is able
to execute that statement. 
As with must interface routines, the first parameter must be a pointer
to an sqlite structure that was obtained from a prior call to
**sqlite\_open**.


A pointer to the virtual machine is stored in a pointer which is passed
in as the 4th parameter.
Space to hold the virtual machine is dynamically allocated. To avoid
a memory leak, the calling function must invoke
**sqlite\_finalize** on the virtual machine after it has finished
with it.
The 4th parameter may be set to NULL if an error is encountered during
compilation.




If any errors are encountered during compilation, an error message is
written into memory obtained from **malloc** and the 5th parameter
is made to point to that memory. If the 5th parameter is NULL, then
no error message is generated. If the 5th parameter is not NULL, then
the calling function should dispose of the memory containing the error
message by calling **sqlite\_freemem**.




If the 2nd parameter actually contains two or more statements of SQL,
only the first statement is compiled. (This is different from the
behavior of **sqlite\_exec** which executes all SQL statements
in its input string.) The 3rd parameter to **sqlite\_compile**
is made to point to the first character beyond the end of the first
statement of SQL in the input. If the 2nd parameter contains only
a single SQL statement, then the 3rd parameter will be made to point
to the '\\000' terminator at the end of the 2nd parameter.




On success, **sqlite\_compile** returns SQLITE\_OK.
Otherwise and error code is returned.



