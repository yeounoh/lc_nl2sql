### 2\.0 Accessing Data Without Using A Callback Function



The **sqlite\_exec** routine described above used to be the only
way to retrieve data from an SQLite database. But many programmers found
it inconvenient to use a callback function to obtain results. So beginning
with SQLite version 2\.7\.7, a second access interface is available that
does not use callbacks.




The new interface uses three separate functions to replace the single
**sqlite\_exec** function.




> ```
> 
> typedef struct sqlite_vm sqlite_vm;
> 
> int sqlite_compile(
>   sqlite *db,              /* The open database */
>   const char *zSql,        /* SQL statement to be compiled */
>   const char **pzTail,     /* OUT: uncompiled tail of zSql */
>   sqlite_vm **ppVm,        /* OUT: the virtual machine to execute zSql */
>   char **pzErrmsg          /* OUT: Error message. */
> );
> 
> int sqlite_step(
>   sqlite_vm *pVm,          /* The virtual machine to execute */
>   int *pN,                 /* OUT: Number of columns in result */
>   const char ***pazValue,  /* OUT: Column data */
>   const char ***pazColName /* OUT: Column names and datatypes */
> );
> 
> int sqlite_finalize(
>   sqlite_vm *pVm,          /* The virtual machine to be finalized */
>   char **pzErrMsg          /* OUT: Error message */
> );
> 
> ```



The strategy is to compile a single SQL statement using
**sqlite\_compile** then invoke **sqlite\_step** multiple times,
once for each row of output, and finally call **sqlite\_finalize**
to clean up after the SQL has finished execution.



