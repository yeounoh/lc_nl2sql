## Recover snapshots from a wal file




> ```
> 
> int sqlite3_snapshot_recover(sqlite3 *db, const char *zDb);
> 
> ```



If a [WAL file](../wal.html#walfile) remains on disk after all database connections close
(either through the use of the [SQLITE\_FCNTL\_PERSIST\_WAL](../c3ref/c_fcntl_begin_atomic_write.html#sqlitefcntlpersistwal) [file control](../c3ref/file_control.html)
or because the last process to have the database opened exited without
calling [sqlite3\_close()](../c3ref/close.html)) and a new connection is subsequently opened
on that database and [WAL file](../wal.html#walfile), the [sqlite3\_snapshot\_open()](../c3ref/snapshot_open.html) interface
will only be able to open the last transaction added to the WAL file
even though the WAL file contains other valid transactions.


This function attempts to scan the WAL file associated with database zDb
of database handle db and make all valid snapshots available to
sqlite3\_snapshot\_open(). It is an error if there is already a read
transaction open on the database, or if the database is not a WAL mode
database.


SQLITE\_OK is returned if successful, or an SQLite error code otherwise.


This interface is only available if SQLite is compiled with the
[SQLITE\_ENABLE\_SNAPSHOT](../compile.html#enable_snapshot) option.


See also lists of
 [Objects](../c3ref/objlist.html),
 [Constants](../c3ref/constlist.html), and
 [Functions](../c3ref/funclist.html).


