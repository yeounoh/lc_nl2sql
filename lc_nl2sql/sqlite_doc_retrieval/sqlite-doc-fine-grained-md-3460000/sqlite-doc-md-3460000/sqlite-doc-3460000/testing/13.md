### 4\.1\.3\. The dbsqlfuzz and jfuzz fuzzers


Beginning in late 2018, SQLite has been fuzzed using a proprietary
fuzzer called "dbsqlfuzz". Dbsqlfuzz is built using the
[libFuzzer](http://llvm.org/docs/LibFuzzer.html) framework of LLVM.



The dbsqlfuzz fuzzer mutates both the SQL input and the database file
at the same time. Dbsqlfuzz uses a custom
[Structure\-Aware Mutator](https://github.com/google/fuzzing/blob/master/docs/structure-aware-fuzzing.md)
on a specialized input file that defines both an input database and SQL
text to be run against that database. Because it mutates both the input
database and the input SQL at the same time, dbsqlfuzz has been able to
find some obscure faults in SQLite that were missed by prior fuzzers that
mutated only SQL inputs or only the database file.
The SQLite developers keep dbsqlfuzz running against trunk in about
16 cores at all times. Each instance of dbsqlfuzz program is able to
evalutes about 400 test cases per second, meaning that about 500 million
cases are checked every day.


The dbsqlfuzz fuzzer has been very successful at hardening the
SQLite code base against malicious attack. Since dbsqlfuzz has been
added to the SQLite internal test suite, bug reports from external
fuzzers such as OSSFuzz have all but stopped.



Note that dbsqlfuzz is *not* the Protobuf\-based structure\-aware
fuzzer for SQLite that is used by Chromium and described in the
[Structure\-Aware Mutator article](https://github.com/google/fuzzing/blob/master/docs/structure-aware-fuzzing.md#user-content-example-sqlite).
There is no connection between these two fuzzers, other than the fact that they
are both based on [libFuzzer](http://llvm.org/docs/LibFuzzer.html)
The Protobuf fuzzer for SQLite is written and maintained by the Chromium
team at Google, whereas dbsqlfuzz is written and maintained by the original
SQLite developers. Having multiple independently\-developed fuzzers for SQLite
is good, as it means that obscure issues are more likely to be uncovered.



Near the end of January 2024, a second libFuzzer\-based tool called
"jfuzz" came into use. Jfuzz generates corrupt [JSONB](json1.html#jsonbx) blobs and feeds
them into the [JSON SQL functions](json1.html) to verify that the JSON functions
are able to safely and efficiently deal with corrupt binary inputs.





