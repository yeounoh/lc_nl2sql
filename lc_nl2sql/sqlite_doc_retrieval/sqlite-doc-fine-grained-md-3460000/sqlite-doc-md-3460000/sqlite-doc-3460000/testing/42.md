## 8\.6\. Undefined Behavior Checks


In the C programming language, it is very easy to write code that
has "undefined" or "implementation defined" behavior.
That means that the code might work during development, but then give
a different answer on a different system, or when recompiled using different
compiler options.
Examples of undefined and implementation\-defined behavior in
ANSI C include:


* Signed integer overflow. (Signed integer overflow does not
necessarily wrap around, as most people expect.)
* Shifting an N\-bit integer by more than N bits.
* Shifting by a negative amount.
* Shifting a negative number.
* Using the memcpy() function on overlapping buffers.
* The order of evaluation of function arguments.
* Whether or not "char" variables are signed or unsigned.
* And so forth....


Since undefined and implementation\-defined behavior is non\-portable
and can easily lead to incorrect answers, SQLite works very hard to avoid it.
For example,
when adding two integer column values together as part of an SQL statement,
SQLite does not simply add them together using the C\-language "\+" operator.
Instead, it first checks to make sure the
addition will not overflow, and if it will, it does the addition using
floating point instead.



To help ensure that SQLite does not make use of undefined or
implementation defined behavior, the test suites are rerun using
instrumented builds that try to detect undefined behavior. For example,
test suites are run using the "\-ftrapv" option of GCC. And they
are run again using the "\-fsanitize\=undefined" option on Clang. And
again using the "/RTC1" option in MSVC. Then the test suites are rerun
using options like "\-funsigned\-char" and "\-fsigned\-char" to make sure
that implementation differences do not matter either. Tests are then repeated
on 32\-bit and 64\-bit systems and on big\-endian and little\-endian systems,
using a variety of CPU architectures.
Furthermore, the test suites are augmented with many test cases that are
deliberately designed to provoke undefined behavior. For example:
"**SELECT \-1\*(\-9223372036854775808\);**".




