# 2\. Test Harnesses


There are four independent test harnesses used for testing the
core SQLite library.
Each test harness is designed, maintained, and managed separately
from the others.



1. The **TCL Tests** are the original tests for SQLite.
They are contained in the same source tree as the
SQLite core and like the SQLite core are in the public domain. The
TCL tests are the primary tests used during development.
The TCL tests are written using the
[TCL scripting language](http://www.tcl-lang.org/).
The TCL test harness itself consists of 27\.2 KSLOC
of C code used to create the TCL interface. The test scripts are contained
in 1390 files totaling
23\.2MB in size. There are
51445 distinct test cases, but many of the test
cases are parameterized and run multiple times (with different parameters)
so that on a full test run millions of
separate tests are performed.
2. The **[TH3](th3.html)** test harness is a set of proprietary tests, written in
C that provide 100% branch test coverage
(and [100% MC/DC test coverage](testing.html#mcdc)) to
the core SQLite library. The TH3 tests are designed to run
on embedded and specialized platforms that would not easily support
TCL or other workstation services. TH3 tests use only the published
SQLite interfaces. TH3 consists of about
76\.9 MB or 1055\.4 KSLOC
of C code implementing 50362 distinct test cases.
TH3 tests are heavily parameterized, though, so a full\-coverage test runs
about 2\.4 million different test
instances.
The cases that provide 100% branch test coverage constitute
a subset of the total TH3 test suite. A soak test
prior to release does about
248\.5 million tests.
Additional information on TH3 is [available separately](th3.html).
3. The [**SQL Logic Test**](https://www.sqlite.org/sqllogictest)
or SLT test harness is used to run huge numbers
of SQL statements against both SQLite and several other SQL database engines
and verify that they all get the same answers. SLT currently compares
SQLite against PostgreSQL, MySQL, Microsoft SQL Server, and Oracle 10g.
SLT runs 7\.2 million queries comprising
1\.12GB of test data.
4. The [**dbsqlfuzz**](#dbsqlfuzz) engine is a
proprietary fuzz tester. Other [fuzzers for SQLite](testing.html#fuzztesting)
mutate either the SQL inputs or the database file. Dbsqlfuzz mutates
both the SQL and the database file at the same time, and is thus able
to reach new error states. Dbsqlfuzz is built using the
[libFuzzer](http://llvm.org/docs/LibFuzzer.html) framework of LLVM
with a custom mutator. There are
336 seed files. The dbsqlfuzz fuzzer
runs about one billion test mutations per day.
Dbsqlfuzz helps ensure
that SQLite is robust against attack via malicious SQL or database
inputs.


In addition to the four main test harnesses, there many other
small programs that implement specialized tests. Here are a few
examples:


1. The "speedtest1\.c" program
estimates the performance of SQLite under a typical workload.
2. The "mptester.c" program is a stress test for multiple processes
concurrently reading and writing a single database.
3. The "threadtest3\.c" program is a stress test for multiple threads using
SQLite simultaneously.
4. The "fuzzershell.c" program is used to
run some [fuzz tests](#fuzztesting).
5. The "jfuzz" program is a libfuzzer\-based fuzzer for
[JSONB](json1.html#jsonbx) inputs to the [JSON SQL functions](json1.html).


All of the tests above must run successfully, on multiple platforms
and under multiple compile\-time configurations,
before each release of SQLite.


Prior to each check\-in to the SQLite source tree, developers
typically run a subset (called "veryquick") of the Tcl tests
consisting of about
304\.7 thousand test cases.
The veryquick tests include most tests other than the anomaly, fuzz, and
soak tests. The idea behind the veryquick tests are that they are
sufficient to catch most errors, but also run in only a few minutes
instead of a few hours.



