## 2\.3\. Implicit versus explicit transactions



An implicit transaction (a transaction that is started automatically,
not a transaction started by BEGIN) is committed automatically when
the last active statement finishes. A statement finishes when its
last cursor closes, which is guaranteed to happen when the
prepared statement is [reset](c3ref/reset.html) or
[finalized](c3ref/finalize.html). Some statements might "finish"
for the purpose of transaction control prior to being reset or finalized,
but there is no guarantee of this. The only way to ensure that a
statement has "finished" is to invoke [sqlite3\_reset()](c3ref/reset.html) or
[sqlite3\_finalize()](c3ref/finalize.html) on that statement. An open [sqlite3\_blob](c3ref/blob.html) used for
incremental BLOB I/O also counts as an unfinished statement.
The [sqlite3\_blob](c3ref/blob.html) finishes when it is [closed](c3ref/blob_close.html).




The explicit COMMIT command runs immediately, even if there are
pending [SELECT](lang_select.html) statements. However, if there are pending
write operations, the COMMIT command
will fail with an error code [SQLITE\_BUSY](rescode.html#busy).




An attempt to execute COMMIT might also result in an [SQLITE\_BUSY](rescode.html#busy) return code
if an another thread or process has an open read connection.
When COMMIT fails in this
way, the transaction remains active and the COMMIT can be retried later
after the reader has had a chance to clear.




In very old versions of SQLite (before version 3\.7\.11 \- 2012\-03\-20\)
the ROLLBACK will fail with an error code
[SQLITE\_BUSY](rescode.html#busy) if there are any pending queries. In more recent
versions of SQLite, the ROLLBACK will proceed and pending statements
will often be aborted, causing them to return an [SQLITE\_ABORT](rescode.html#abort) or
[SQLITE\_ABORT\_ROLLBACK](rescode.html#abort_rollback) error.
In SQLite version 3\.8\.8 (2015\-01\-16\) and later,
a pending read will continue functioning
after the ROLLBACK as long as the ROLLBACK does not modify the database
schema.




If [PRAGMA journal\_mode](pragma.html#pragma_journal_mode) is set to OFF (thus disabling the rollback journal
file) then the behavior of the ROLLBACK command is undefined.



