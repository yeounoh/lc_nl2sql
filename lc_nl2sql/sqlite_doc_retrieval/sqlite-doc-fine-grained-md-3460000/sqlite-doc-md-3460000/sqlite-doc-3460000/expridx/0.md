




Indexes On Expressions




[![SQLite](images/sqlite370_banner.gif)](index.html)


Small. Fast. Reliable.  
Choose any three.


* [Home](index.html)* [Menu](javascript:void(0))* [About](about.html)* [Documentation](docs.html)* [Download](download.html)* [License](copyright.html)* [Support](support.html)* [Purchase](prosupport.html)* [Search](javascript:void(0))




* [About](about.html)* [Documentation](docs.html)* [Download](download.html)* [Support](support.html)* [Purchase](prosupport.html)






Search Documentation
Search Changelog










Indexes On Expressions



Normally, an SQL index references columns of a table. But an index
can also be formed on expressions involving table columns.




As an example, consider the following table that tracks
dollar\-amount changes on various "accounts":




```
CREATE TABLE account_change(
  chng_id INTEGER PRIMARY KEY,
  acct_no INTEGER REFERENCES account,
  location INTEGER REFERENCES locations,
  amt INTEGER,  -- in cents
  authority TEXT,
  comment TEXT
);
CREATE INDEX acctchng_magnitude ON account_change(acct_no, abs(amt));

```


Each entry in the account\_change table records a deposit or a withdrawal
into an account. Deposits have a positive "amt" and withdrawals have
a negative "amt".




The acctchng\_magnitude index is over the account number ("acct\_no") and
on the absolute value of the amount. This index allows one to do 
efficient queries over the magnitude of a change to the account.
For example, to list all changes to account number $xyz that are
more than $100\.00, one can say:





```
SELECT * FROM account_change WHERE acct_no=$xyz AND abs(amt)>=10000;

```


Or, to list all changes to one particular account ($xyz) in order of
decreasing magnitude, one can write:




```
SELECT * FROM account_change WHERE acct_no=$xyz
 ORDER BY abs(amt) DESC;

```


Both of the above example queries would work fine without the
acctchng\_magnitude index.
The acctchng\_magnitude index merely helps the queries to run
faster, especially on databases where there are many entries in
the table for each account.



