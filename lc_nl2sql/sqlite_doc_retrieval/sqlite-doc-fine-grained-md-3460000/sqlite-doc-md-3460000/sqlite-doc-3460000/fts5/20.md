### 4\.3\.4\. The Trigram Tokenizer



The trigram tokenizer extends FTS5 to support substring
matching in general, instead of the usual token matching. When using the
trigram tokenizer, a query or phrase token may match any sequence of characters
within a row, not just a complete token. For example:




```
CREATE VIRTUAL TABLE tri USING fts5(a, tokenize="trigram");
INSERT INTO tri VALUES('abcdefghij KLMNOPQRST uvwxyz');

-- The following queries all match the single row in the table
SELECT * FROM tri('cdefg');
SELECT * FROM tri('cdefg AND pqr');
SELECT * FROM tri('"hij klm" NOT stuv');

```


The trigram tokenizer supports the following options: 





| Option | Usage |
| --- | --- |
| case\_sensitive | This value may be set to 1 or 0 (the default). If it is set to 1,  then matching is case sensitive. Otherwise, if this option is set to  0, matching is case insensitive. |
| remove\_diacritics | This value may also be set to 1 or 0 (the default). It may only  be set to 1 if the case\_sensitive options is set to 0 \- setting both  options to 1 is an error. If this option is set, then diacritics are  removed from the text before matching (e.g. so that "รก" matches "a"). |



```
-- A case-sensitive trigram index
CREATE VIRTUAL TABLE tri USING fts5(a, tokenize="trigram case_sensitive 1");

```


Unless the remove\_diacritics option is set, FTS5 tables that use the trigram
tokenizer also support indexed GLOB and LIKE pattern matching. For example:




```
SELECT * FROM tri WHERE a LIKE '%cdefg%';
SELECT * FROM tri WHERE a GLOB '*ij klm*xyz';

```


If an FTS5 trigram tokenizer is created with the case\_sensitive option set to 1,
it may only index GLOB queries, not LIKE.




Notes:



* Substrings consisting of fewer than 3 unicode characters do not match any
 rows when used with a full\-text query. If a LIKE or GLOB pattern does not
 contain at least one sequence of non\-wildcard unicode characters, FTS5
 falls back to a linear scan of the entire table.
* If the FTS5 table is created with the detail\=none or detail\=column option
 specified, full\-text queries may not contain any tokens longer than 3
 unicode characters. LIKE and GLOB pattern matching may be slightly slower,
 but still works. If the index is to be used only for LIKE and/or GLOB
 pattern matching, these options are worth experimenting with to reduce
 the index size.
* The index cannot be used to optimize LIKE patterns if the LIKE operator
 has an ESCAPE clause.



