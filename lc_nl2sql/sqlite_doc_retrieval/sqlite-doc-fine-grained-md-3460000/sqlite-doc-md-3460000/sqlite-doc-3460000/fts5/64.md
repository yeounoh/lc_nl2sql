### 9\.2\.1\. The %\_data Table Rowid Space



```
CREATE TABLE %_data(
  id INTEGER PRIMARY KEY,
  block BLOB
);

```

The %\_data table is used to store three types of records:



* The special [structure record](#structure_record_format),
 stored with id\=10\.
* The special [averages record](#averages_record_format),
 stored with id\=1\.
* A record to store each [segment b\-tree](#segment_b_tree_format)
 leaf and [doclist index](#doclist_index_format) leaf and
 internal node. See below for how id values are calculated for these
 records.


Each segment b\-tree in the system is assigned a unique 16\-bit segment id.
Segment ids may only be reused after the original owner segment b\-tree is
completely merged into a higher level segment b\-tree. Within a segment b\-tree,
each leaf page is assigned a unique page number \- 1 for the first leaf page, 2
for the second, and so on.



Each doclist index leaf page is also assigned a page number. The first
(leftmost) leaf page in a doclist index is assigned the same page number as
the segment b\-tree leaf page on which its term appears (because doclist indexes
are only created for terms with very long doclists, at most one term per
segment b\-tree leaf has an associated doclist index). Call this page number P.
If the doclist is so large that it requires a second leaf, the second leaf is
assigned page number P\+1\. The third leaf P\+2\. Each tier of a doclist index
b\-tree (leaves, parents of leaves, grandparents etc.) is assigned page numbers
in this fashion, starting with page number P.



The "id" value used in the %\_data table to store any given segment b\-tree
leaf or doclist index leaf or node is composed as follows:





| RowidÂ Bits | Contents |
| --- | --- |
| 38\..43 | (16 bit) Segment b\-tree id value. |
| 37 | (1 bit) Doclist index flag. Set for doclist index pages, clear  for segment b\-tree leaves. |
| 32\..36 | (5 bits) Height in tree. This is set to 0 for segment b\-tree  and doclist index leaves, to 1 for the parents of doclist  index leaves, 2 for the grandparents, etc. |
| 0\..31 | (32 bits) Page number |


