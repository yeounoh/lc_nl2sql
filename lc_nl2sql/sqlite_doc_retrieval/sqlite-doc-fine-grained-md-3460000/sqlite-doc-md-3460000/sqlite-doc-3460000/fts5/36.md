## 6\.1\. The 'automerge' Configuration Option



 Instead of using a single data structure on disk to store the full\-text
 index, FTS5 uses a series of b\-trees. Each time a new transaction is
 committed, a new b\-tree containing the contents of the committed transaction
 is written into the database file. When the full\-text index is queried, each
 b\-tree must be queried individually and the results merged before being
 returned to the user.




 In order to prevent the number of b\-trees in the database from becoming too
 large (slowing down queries), smaller b\-trees are periodically merged into
 single larger b\-trees containing the same data. By default, this happens
 automatically within INSERT, UPDATE or DELETE statements that modify the
 full\-text index. The 'automerge' parameter determines how many smaller
 b\-trees are merged together at a time. Setting it to a small value can
 speed up queries (as they have to query and merge the results from fewer
 b\-trees), but can also slow down writing to the database (as each INSERT,
 UPDATE or DELETE statement has to do more work as part of the automatic
 merging process).




 Each of the b\-trees that make up the full\-text index is assigned to a "level"
 based on its size. Level\-0 b\-trees are the smallest, as they contain the
 contents of a single transaction. Higher level b\-trees are the result of
 merging two or more level\-0 b\-trees together and so they are larger. FTS5
 begins to merge b\-trees together once there exist *M* or more b\-trees
 with the same level, where *M* is the value of the 'automerge'
 parameter.




 The maximum allowed value for the 'automerge' parameter is 16\. The default
 value is 4\. Setting the 'automerge' parameter to 0 disables the automatic
 incremental merging of b\-trees altogether.




```
INSERT INTO ft(ft, rank) VALUES('automerge', 8);

```

