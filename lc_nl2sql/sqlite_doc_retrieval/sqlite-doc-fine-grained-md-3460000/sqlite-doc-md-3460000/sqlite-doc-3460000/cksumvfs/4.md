# 4\. Usage


Open database connections using the [sqlite3\_open()](c3ref/open.html) or 
[sqlite3\_open\_v2()](c3ref/open.html) interfaces, as normal. Ordinary database files
(without a checksum) will operate normally. Databases with 
checksums will return an SQLITE\_IOERR\_DATA error if a page is
encountered that contains an invalid checksum.



Checksumming only works on databases that have a [reserve bytes](fileformat2.html#resbyte)
value of exactly 8\. The default value for reserve\-bytes is 0\.
Hence, newly created database files will omit the checksum by
default. To create a database that includes a checksum, change
the reserve\-bytes value to 8 by running code similar to this:




```
int n = 8;
sqlite3_file_control(db, 0, SQLITE_FCNTL_RESERVE_BYTES, &n);

```

If you do this immediately after creating a new database file,
before anything else has been written into the file, then that
might be all that you need to do. Otherwise, the API call
above should be followed by:




```
sqlite3_exec(db, "VACUUM", 0, 0, 0);

```

It never hurts to run the VACUUM, even if you don't need it.
If the database is in WAL mode, you should shutdown and
reopen all database connections before continuing.



From the CLI, use the ".filectrl reserve\_bytes 8" command, 
followed by "VACUUM;".



Note that SQLite allows the number of reserve\-bytes to be
increased but not decreased. So if a database file already
has a reserve\-bytes value greater than 8, there is no way to
activate checksumming on that database, other than to dump
and restore the database file. Note also that other extensions
might also make use of the reserve\-bytes. Checksumming will
be incompatible with those other extensions.



