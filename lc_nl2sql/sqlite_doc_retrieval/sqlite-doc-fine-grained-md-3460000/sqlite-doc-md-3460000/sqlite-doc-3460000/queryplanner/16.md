## 3\.1\.  Searching And Sorting With A Multi\-Column Index



Suppose we want to find the prices of all kinds of oranges sorted in
order of the state where they are grown. The query is this:





| ```  SELECT price FROM fruitforsale WHERE fruit='Orange' ORDER BY state  ``` |
| --- |



The query contains both a search restriction in the WHERE clause
and a sort order in the ORDER BY clause. Both the search and the sort
can be accomplished at the same time using the two\-column index Idx3\.





![figure 20](images/qp/fruitobstate0.gif)  

Figure 20: Search And Sort By Multi\-Column Index




The query does a binary search on the index to find the subset of rows
that have fruit\='Orange'. (Because the fruit column is the left\-most column
of the index and the rows of the index are in sorted order, all such 
rows will be adjacent.) Then it scans the matching index rows from top to
bottom to get the rowids for the original table, and for each rowid does
a binary search on the original table to find the price.




You will notice that there is no "sort" box anywhere in the above diagram.
The ORDER BY clause of the query has become a no\-op. No sorting has to be
done here because the output order is by the state column and the state
column also happens to be the first column after the fruit column in the
index. So, if we scan entries of the index that have the same value for
the fruit column from top to bottom, those index entries are guaranteed to
be ordered by the state column.




