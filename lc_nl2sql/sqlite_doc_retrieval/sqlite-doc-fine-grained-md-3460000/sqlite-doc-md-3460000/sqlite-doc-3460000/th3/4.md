# 3\. Generating A Test Program


The TH3 program generator is a TCL script named "mkth3\.tcl".
To generate a test program, one has merely to run this script and supply
the names of files containing test modules and configurations on the
command line. Test modules are files that use the ".test" suffix
and configurations are files that use the ".cfg" suffix. A
typical invocation of mkth3\.tcl might look something like the following:



```
tclsh mkth3.tcl *.test *.cfg >testprog1.c

```

The output from the mkth3\.tcl script is a C program that contains
everything needed to run the tests \- everything that is except for
the SQLite library itself. The generated test program contains 
implementations for all of the support interfaces used by the test
modules and it contains the main() routine that drives the
tests. To convert the test program into a working executable, simply
compile it against SQLite:



```
cc -o testprog1 testprog1.c sqlite3.c

```

The compilation step shown immediately above is merely representative.
In a working installation, one would normally want
to specify optimization parameters and compile\-time switches on the
compiler command line.


For testing on embedded systems, the mkth3\.tcl script and the compiler
steps shown above are performed on an ordinary workstation using
a cross\-compiler, then the resulting test program is
transferred onto the device to be run.


Once the test program is generated, it is run with no arguments to
perform the tests. Progress information as well as error diagnostics
appear on standard output. (Alternative output arrangements can be made
using a compile\-time option for embedded devices that lack a standard
output channel.) The program returns zero if there are no
errors and non\-zero if any problems were detected.


Typical output from a single TH3 test program run looks like this:




```
With SQLite 3.8.11 2015-05-15 04:13:15 56ef98a04765c34c1c2f3ed7a6f03a732f3b886e
-DSQLITE_COVERAGE_TEST
-DSQLITE_NO_SYNC
-DSQLITE_SYSTEM_MALLOC
-DSQLITE_THREADSAFE=1
Config-begin c1.
Begin c1.pager08
End c1.pager08
Begin c1.build33
End c1.build33
Begin c1.orderby01
End c1.orderby01
... 15014 lines of output omitted ....
Begin 64k.syscall01
End 64k.syscall01
Begin 64k.build01
End 64k.build01
Begin 64k.auth01
End 64k.auth01
Config-end 64k. TH3 memory used: 6373738
Config-begin wal1.
Begin wal1.wal37
End wal1.wal37
Config-end wal1. TH3 memory used: 100961
All 226 VDBE coverage points reached
th3: 0 errors out of 1442264 tests in 213.741 seconds. 64-bit little-endian
th3: SQLite 3.8.11 2015-05-15 04:13:15 56ef98a04765c34c1c2f3ed7a6f03a732f3b886e

```

The output begins with a report of the [SQLITE\_SOURCE\_ID](c3ref/c_source_id.html)
(cross\-checked again [sqlite3\_sourceid()](c3ref/libversion.html)) for the
SQLite under test and the compile\-time options used as reported
by [sqlite3\_compileoption\_get()](c3ref/compileoption_get.html). The output concludes with a summary
of the test results and a repeat of the [SQLITE\_SOURCE\_ID](c3ref/c_source_id.html). If any
errors are detected, additional lines detail the problem. The error
reporting lines always begin with a single space character so that they
can be quickly extracted from large output files using:




```
grep "^ "

```

The default output shows the beginning and end of each configuration
and test module combination. In the example above "c1" and "64k" are
configurations and "pager08", "build33", "orderby01", etc. are test modules.
Compile\-time and run\-time options are available to increase or decrease
the amount of output.
The output can be increased by showing each test case within each
test module. The output can be decreased
by degrees: omitting test modules starts and stops,
omitting configuration starts and stops, and finally by omitting all output.



