# 4\. The ORDER BY clause


If a SELECT statement that returns more than one row does not have an
ORDER BY clause, the order in which the rows are returned is undefined.
Or, if a SELECT statement does have an ORDER BY clause, then the list of
expressions attached to the ORDER BY determine the order in which rows
are returned to the user.




In a [compound SELECT](lang_select.html#compound) statement, only the last or right\-most [simple SELECT](lang_select.html#simpleselect)
may have an ORDER BY clause. That ORDER BY clause will apply across all elements of
the compound. If the right\-most element of a [compound SELECT](lang_select.html#compound) is a [VALUES](lang_select.html#values) clause,
then no ORDER BY clause is allowed on that statement.




Rows are first sorted based on the results of
evaluating the left\-most expression in the ORDER BY list, then ties are broken
by evaluating the second left\-most expression and so on. The order in which
two rows for which all ORDER BY expressions evaluate to equal values are
returned is undefined. Each ORDER BY expression may be optionally followed
by one of the keywords ASC (smaller values are returned first) or DESC (larger
values are returned first). If neither ASC or DESC are specified, rows
are sorted in ascending (smaller values first) order by default.




SQLite considers NULL values to be smaller than any other values
for sorting purposes. Hence, NULLs naturally appear at the beginning
of an ASC order\-by and at the end of a DESC order\-by. This can be changed
using the "ASC NULLS LAST" or "DESC NULLS FIRST" syntax.



Each ORDER BY expression is processed as follows:


1. If the ORDER BY expression is a constant integer K then the
expression is considered an alias for the K\-th column of the result set
(columns are numbered from left to right starting with 1\).
2. If the ORDER BY expression is an identifier that corresponds to
the alias of one of the output columns, then the expression is considered
an alias for that column.
3. Otherwise, if the ORDER BY expression is any other expression, it 
is evaluated and the returned value used to order the output rows. If
the SELECT statement is a simple SELECT, then an ORDER BY may contain any
arbitrary expressions. However, if the SELECT is a compound SELECT, then
ORDER BY expressions that are not aliases to output columns must be exactly
the same as an expression used as an output column.


For the purposes of sorting rows, values are compared in the same way
as for [comparison expressions](datatype3.html#comparisons). The collation sequence used to compare
two text values is determined as follows:



1. If the ORDER BY expression is assigned a collation sequence using
 the postfix [COLLATE operator](lang_expr.html#collateop), then the specified collation sequence is
 used.
2. Otherwise, if the ORDER BY expression is an alias to an expression
 that has been assigned a collation sequence using the postfix 
 [COLLATE operator](lang_expr.html#collateop), then the collation sequence assigned to the aliased
 expression is used.
3. Otherwise, if the ORDER BY expression is a column or an alias of
 an expression that is a column, then the default collation sequence for
 the column is used.
4. Otherwise, the [BINARY](datatype3.html#collation) collation sequence is used.


In a [compound SELECT](lang_select.html#compound) statement, all ORDER BY expressions are handled
as aliases for one of the result columns of the compound.
If an ORDER BY expression is not an integer alias, then SQLite searches
the left\-most SELECT in the compound for a result column that matches either
the second or third rules above. If a match is found, the search stops and
the expression is handled as an alias for the result column that it has been
matched against. Otherwise, the next SELECT to the right is tried, and so on.
If no matching expression can be found in the result columns of any
constituent SELECT, it is an error. Each term of the ORDER BY clause is
processed separately and may be matched against result columns from different
SELECT statements in the compound.



