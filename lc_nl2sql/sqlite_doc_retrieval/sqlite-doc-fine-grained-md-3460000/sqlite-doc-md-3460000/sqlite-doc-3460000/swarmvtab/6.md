## 3\.3\. The "openclose" Callback


The "openclose" parameter allows the user to specify the name of a
[application\-defined SQL function](appfunc.html) that will be invoked just before
swarmvtab opens a database, and again just after it closes one. The first
argument passed to the open close function is the filename or URI
identifying the database to be opened or just recently closed (the same
value returned in the leftmost column of the SQL statement provided to
the CREATE VIRTUAL TABLE command). The second argument is integer value
0 when the function is invoked before opening a database, and 1 when it
is invoked after one is closed. For example, if:




```
CREATE VIRTUAL TABLE temp.x1 USING swarmvtab (
  "SELECT ...",
  openclose = 'openclose_udf'
);

```

then before each database containing a component table is opened, 
swarmvtab effectively executes:




```
SELECT openclose_udf(<database-name>, 0);

```

After a database is closed, swarmvtab runs the equivalent of:




```
SELECT openclose_udf(<database-name>, 1);

```

Any value returned by the openclose function is ignored. If an invocation
made before opening a database returns an error, then the database file is
not opened and the error returned to the user. This is the only scenario
in which swarmvtab will issue an "open" invocation without also eventually
issuing a corresponding "close" call. If there are still databases open,
"close" calls may be issued from within the eventual sqlite3\_close() call
on the applications database that deletes the temp schema in which the
swarmvtab table resides.



Errors returned by "close" invocations are always ignored.




