# 14\. Database Content Self\-Tests


The ".selftest" command attempts to verify that a database is
intact and is not corrupt.
The .selftest command looks for a table in schema named "selftest"
and defined as follows:




```
CREATE TABLE selftest(
  tno INTEGER PRIMARY KEY,  -- Test number
  op TEXT,                  -- 'run' or 'memo'
  cmd TEXT,                 -- SQL command to run, or text of "memo"
  ans TEXT                  -- Expected result of the SQL command
);

```

The .selftest command reads the rows of the selftest table in
selftest.tno order.
For each 'memo' row, it writes the text in 'cmd' to the output. For
each 'run' row, it runs the 'cmd' text as SQL and compares the result
to the value in 'ans', and shows an error message if the results differ.



If there is no selftest table, the ".selftest" command runs
[PRAGMA integrity\_check](pragma.html#pragma_integrity_check).



The ".selftest \-\-init" command creates the selftest table if it
does not already exists, then appends entries that check the SHA3
hash of the content of all tables. Subsequent runs of ".selftest"
will verify that the database has not been changed in any way. To
generate tests to verify that a subset of the tables is unchanged,
simply run ".selftest \-\-init" then [DELETE](lang_delete.html) the selftest rows that
refer to tables that are not constant.




