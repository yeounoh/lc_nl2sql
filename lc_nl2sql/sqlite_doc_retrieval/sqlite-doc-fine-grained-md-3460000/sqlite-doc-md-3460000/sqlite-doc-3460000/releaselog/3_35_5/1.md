## SQLite Release 3\.35\.5 On 2021\-04\-19

**Prior changes from version 3\.35\.0 (2021\-03\-12\):**


1. Added [built\-in SQL math functions()](../lang_mathfunc.html). (Requires the
 [\-DSQLITE\_ENABLE\_MATH\_FUNCTIONS](../compile.html#enable_math_functions) compile\-time option.)
- Added support for [ALTER TABLE DROP COLUMN](../lang_altertable.html#altertabdropcol).
- Generalize [UPSERT](../lang_upsert.html):
	1. Allow multiple ON CONFLICT clauses that are evaluated in order,
	 - The final ON CONFLICT clause may omit the conflict target and
	 yet still use DO UPDATE.- Add support for the [RETURNING](../lang_returning.html) clause on [DELETE](../lang_delete.html), [INSERT](../lang_insert.html), and
 [UPDATE](../lang_update.html) statements.
- Use less memory when running [VACUUM](../lang_vacuum.html) on databases containing very large
 TEXT or BLOB values. It is no longer necessary to hold the entire TEXT
 or BLOB in memory all at once.
- Add support for the [MATERIALIZED](../lang_with.html#mathint) and [NOT MATERIALIZED](../lang_with.html#mathint) hints when
 specifying [common table expressions](../lang_with.html). The default behavior was
 formerly NOT MATERIALIZED, but is now changed to MATERIALIZED for
 CTEs that are used more than once.
- The [SQLITE\_DBCONFIG\_ENABLE\_TRIGGER](../c3ref/c_dbconfig_defensive.html#sqlitedbconfigenabletrigger) and [SQLITE\_DBCONFIG\_ENABLE\_VIEW](../c3ref/c_dbconfig_defensive.html#sqlitedbconfigenableview)
 settings are modified so that they only control triggers and views
 in the main database schema or in attached database schemas and not in
 the TEMP schema. TEMP triggers and views are always allowed.
- Query planner/optimizer improvements:
	1. Enhancements to the [min/max optimization](../optoverview.html#minmax) so that it works better
	 with the IN operator and the OP\_SeekScan optimization of the
	 previous release.
	 - Attempt to process EXISTS operators in the WHERE clause as if
	 they were IN operators, in cases where this is a valid transformation
	 and seems likely to improve performance.
	 - Allow UNION ALL sub\-queries to be [flattened](../optoverview.html#flattening) even if the parent query is a join.
	 - Use an index, if appropriate, on IS NOT NULL expressions in the WHERE clause,
	 even if STAT4 is disabled.
	 - Expressions of the form "x IS NULL" or "x IS NOT NULL" might be converted to simply
	 FALSE or TRUE, if "x" is a column that has a "NOT NULL" constraint and is not
	 involved in an outer join.
	 - Avoid checking foreign key constraints on an UPDATE statement if the UPDATE does
	 not modify any columns associated with the foreign key.
	 - Allow WHERE terms to be [pushed down](../optoverview.html#pushdown) into sub\-queries
	 that contain window functions,
	 as long as the WHERE term is made up of entirely of constants and copies of expressions
	 found in the PARTITION BY clauses of all window functions in the sub\-query.- [CLI](../cli.html) enhancements:
	1. Enhance the ".stats" command to accept new arguments "stmt" and
	 "vmstep", causing prepare statement statistics and only the
	 virtual\-machine step count to be shown, respectively.
	 - Add the ".filectrl data\_version" command.
	 - Enhance the ".once" and ".output" commands so that if the destination argument
	 begins with "\|" (indicating that output is redirected into a pipe) then the
	 argument does not need to be quoted.- Bug fixes:
	1. Fix a potential NULL pointer dereference when processing a
	 syntactically incorrect SELECT statement with a correlated WHERE
	 clause and a "HAVING 0" clause. (Also fixed in the 3\.34\.1 patch release.)
	 - Fix a [bug in the IN\-operator optimization](https://www.sqlite.org/src/info/ee51301f316c09e9)
	 of version 3\.33\.0 that can cause an incorrect answer.
	 - Fix incorrect answers from the [LIKE operator](../lang_expr.html#like) if the pattern ends with "%" and there
	 is an "ESCAPE '\_'" clause.


**Prior changes from version 3\.35\.1 (2021\-03\-15\):**


1. Fix [a bug](https://www.sqlite.org/src/info/1c24a659e6d7f3a1) in the new DROP COLUMN
 feature when used on columns that are indexed and that are quoted in the index
 definition.
- Improve the built\-in documentation for the [.dump](../cli.html#dump) command in the [CLI](../cli.html).


**Prior changes from version 3\.35\.2 (2021\-03\-17\):**


1. Fix a problem in the
 [appendvfs.c](https://www.sqlite.org/src/file/ext/misc/appendvfs.c)
 extension that was introduced into version 3\.35\.0\.
- Ensure that date/time functions with no arguments (which generate
 responses that depend on the current time) are treated as
 [non\-deterministic functions](../deterministic.html). Ticket
 [2c6c8689fb5f3d2f](https://sqlite.org/src/info/2c6c8689fb5f3d2f)- Fix a problem in the [sqldiff](../sqldiff.html) utility program having to do with
 unusual whitespace characters in a [virtual table](../vtab.html) definition.
- Limit the new UNION ALL optimization described by item 8c in the
 3\.35\.0 release so that it does not try to make too many new subqueries.
 See [forum thread 140a67d3d2](https://sqlite.org/forum/forumpost/140a67d3d2)
 for details.


**Prior changes from version 3\.35\.3 (2021\-03\-26\):**


1. Enhance the OP\_OpenDup opcode of the [bytecode engine](../opcode.html) so that it works even if the
 cursor being duplicated itself came from OP\_OpenDup. Fix for
 [ticket bb8a9fd4a9b7fce5](https://www.sqlite.org/src/info/bb8a9fd4a9b7fce5).
 This problem only came to light due to the recent MATERIALIZED hint enhancement.
- When materializing correlated [common table expressions](../lang_with.html), do so separately for each
 use case, as that is required for correctness. This fixes a problem that was
 introduced by the MATERIALIZED hint enhancement.
- Fix a problem in the filename normalizer of the unix [VFS](../vfs.html).
- Fix the ["box" output mode](../cli.html#dotmode) in the [CLI](../cli.html) so that it works with statements that
 returns one or more rows of zero columns (such as [PRAGMA incremental\_vacuum](../pragma.html#pragma_incremental_vacuum)).
 [Forum post afbbcb5b72](https://sqlite.org/forum/forumpost/afbbcb5b72).
- Improvements to error messages generated by faulty common table expressions.
 [Forum post aa5a0431c99e](https://sqlite.org/forum/forumpost/aa5a0431c99e631).
- Fix some incorrect assert() statements.
- Fix to the [SELECT statement syntax diagram](../syntax/select-stmt.html) so that the FROM clause
 syntax is shown correctly.
 [Forum post 9ed02582fe](https://sqlite.org/forum/forumpost/9ed02582fe).
- Fix the EBCDIC character classifier so that it understands newlines as whitespace.
 [Forum post 58540ce22dcd](https://sqlite.org/forum/forumpost/58540ce22dcd5fdcd).
- Improvements the [xBestIndex](../vtab.html#xbestindex) method in the implementation of the
 (unsupported) [wholenumber virtual table](https://sqlite.org/src/file/ext/misc/wholenumber.c)
 extension so that it does a better job of convincing the query planner to
 avoid trying to materialize a table with an infinite number of rows.
 [Forum post b52a020ce4](https://sqlite.org/forum/forumpost/b52a020ce4).


**Prior changes from version 3\.35\.4 (2021\-04\-02\):**


1. Fix a defect in the query planner optimization identified by
 item 8b above. Ticket
 [de7db14784a08053](https://sqlite.org/src/info/de7db14784a08053).
- Fix a defect in the new [RETURNING](../lang_returning.html) syntax. Ticket
 [132994c8b1063bfb](https://sqlite.org/src/info/132994c8b1063bfb).
- Fix the new [RETURNING](../lang_returning.html) feature so that it raises an error if one of
 the terms in the RETURNING clause references a unknown table, instead
 of silently ignoring that error.
- Fix an assertion associated with aggregate function processing that
 was incorrectly triggered by the [push\-down optimization](../optoverview.html#pushdown).


**Changes in this specific patch release, version 3\.35\.5 (2021\-04\-19\):**


1. Fix defects in the new ALTER TABLE DROP COLUMN feature that could
 corrupt the database file.
- Fix an obscure query optimizer problem that might cause an incorrect
 query result.
**Hashes:**
- SQLITE\_SOURCE\_ID: 2021\-04\-19 18:32:05 1b256d97b553a9611efca188a3d995a2fff712759044ba480f9a0c9e98fae886
- SHA3\-256 for sqlite3\.c: e42291343e8f03940e57fffcf1631e7921013b94419c2f943e816d3edf4e1bbe



A [complete list of SQLite releases](../changes.html)
 in a single page and a [chronology](../chronology.html) are both also available.
 A detailed history of every
 check\-in is available at
 [SQLite version control site](https://www.sqlite.org/src/timeline).












