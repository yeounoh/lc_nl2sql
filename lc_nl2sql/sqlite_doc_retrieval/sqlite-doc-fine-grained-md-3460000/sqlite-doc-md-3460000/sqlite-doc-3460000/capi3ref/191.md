## Opening A New Database Connection




> ```
> 
> int sqlite3_open(
>   const char *filename,   /* Database filename (UTF-8) */
>   sqlite3 **ppDb          /* OUT: SQLite db handle */
> );
> int sqlite3_open16(
>   const void *filename,   /* Database filename (UTF-16) */
>   sqlite3 **ppDb          /* OUT: SQLite db handle */
> );
> int sqlite3_open_v2(
>   const char *filename,   /* Database filename (UTF-8) */
>   sqlite3 **ppDb,         /* OUT: SQLite db handle */
>   int flags,              /* Flags */
>   const char *zVfs        /* Name of VFS module to use */
> );
> 
> ```



These routines open an SQLite database file as specified by the
filename argument. The filename argument is interpreted as UTF\-8 for
sqlite3\_open() and sqlite3\_open\_v2() and as UTF\-16 in the native byte
order for sqlite3\_open16(). A [database connection](#sqlite3) handle is usually
returned in \*ppDb, even if an error occurs. The only exception is that
if SQLite is unable to allocate memory to hold the [sqlite3](#sqlite3) object,
a NULL will be written into \*ppDb instead of a pointer to the [sqlite3](#sqlite3)
object. If the database is opened (and/or created) successfully, then
[SQLITE\_OK](#SQLITE_ABORT) is returned. Otherwise an [error code](rescode.html) is returned. The
[sqlite3\_errmsg()](#sqlite3_errcode) or [sqlite3\_errmsg16()](#sqlite3_errcode) routines can be used to obtain
an English language description of the error following a failure of any
of the sqlite3\_open() routines.


The default encoding will be UTF\-8 for databases created using
sqlite3\_open() or sqlite3\_open\_v2(). The default encoding for databases
created using sqlite3\_open16() will be UTF\-16 in the native byte order.


Whether or not an error occurs when it is opened, resources
associated with the [database connection](#sqlite3) handle should be released by
passing it to [sqlite3\_close()](#sqlite3_close) when it is no longer required.


The sqlite3\_open\_v2() interface works like sqlite3\_open()
except that it accepts two additional parameters for additional control
over the new database connection. The flags parameter to
sqlite3\_open\_v2() must include, at a minimum, one of the following
three flag combinations:



[SQLITE\_OPEN\_READONLY](#SQLITE_OPEN_AUTOPROXY)
The database is opened in read\-only mode. If the database does
not already exist, an error is returned.


[SQLITE\_OPEN\_READWRITE](#SQLITE_OPEN_AUTOPROXY)
The database is opened for reading and writing if possible, or
reading only if the file is write protected by the operating
system. In either case the database must already exist, otherwise
an error is returned. For historical reasons, if opening in
read\-write mode fails due to OS\-level permissions, an attempt is
made to open it in read\-only mode. [sqlite3\_db\_readonly()](#sqlite3_db_readonly) can be
used to determine whether the database is actually
read\-write.


[SQLITE\_OPEN\_READWRITE](#SQLITE_OPEN_AUTOPROXY) \| [SQLITE\_OPEN\_CREATE](#SQLITE_OPEN_AUTOPROXY)
The database is opened for reading and writing, and is created if
it does not already exist. This is the behavior that is always used for
sqlite3\_open() and sqlite3\_open16().



In addition to the required flags, the following optional flags are
also supported:



[SQLITE\_OPEN\_URI](#SQLITE_OPEN_AUTOPROXY)
The filename can be interpreted as a URI if this flag is set.


[SQLITE\_OPEN\_MEMORY](#SQLITE_OPEN_AUTOPROXY)
The database will be opened as an in\-memory database. The database
is named by the "filename" argument for the purposes of cache\-sharing,
if shared cache mode is enabled, but the "filename" is otherwise ignored.



[SQLITE\_OPEN\_NOMUTEX](#SQLITE_OPEN_AUTOPROXY)
The new database connection will use the "multi\-thread"
[threading mode](threadsafe.html). This means that separate threads are allowed
to use SQLite at the same time, as long as each thread is using
a different [database connection](#sqlite3).


[SQLITE\_OPEN\_FULLMUTEX](#SQLITE_OPEN_AUTOPROXY)
The new database connection will use the "serialized"
[threading mode](threadsafe.html). This means the multiple threads can safely
attempt to use the same database connection at the same time.
(Mutexes will block any actual concurrency, but in this mode
there is no harm in trying.)


[SQLITE\_OPEN\_SHAREDCACHE](#SQLITE_OPEN_AUTOPROXY)
The database is opened [shared cache](sharedcache.html) enabled, overriding
the default shared cache setting provided by
[sqlite3\_enable\_shared\_cache()](#sqlite3_enable_shared_cache).
The [use of shared cache mode is discouraged](sharedcache.html#dontuse) and hence shared cache
capabilities may be omitted from many builds of SQLite. In such cases,
this option is a no\-op.


[SQLITE\_OPEN\_PRIVATECACHE](#SQLITE_OPEN_AUTOPROXY)
The database is opened [shared cache](sharedcache.html) disabled, overriding
the default shared cache setting provided by
[sqlite3\_enable\_shared\_cache()](#sqlite3_enable_shared_cache).



[SQLITE\_OPEN\_EXRESCODE](#SQLITE_OPEN_AUTOPROXY)
The database connection comes up in "extended result code mode".
In other words, the database behaves has if
[sqlite3\_extended\_result\_codes(db,1\)](#sqlite3_extended_result_codes) where called on the database
connection as soon as the connection is created. In addition to setting
the extended result code mode, this flag also causes [sqlite3\_open\_v2()](#sqlite3_open)
to return an extended result code.



[SQLITE\_OPEN\_NOFOLLOW](#SQLITE_OPEN_AUTOPROXY)
The database filename is not allowed to contain a symbolic link



If the 3rd parameter to sqlite3\_open\_v2() is not one of the
required combinations shown above optionally combined with other
[SQLITE\_OPEN\_\* bits](#SQLITE_OPEN_AUTOPROXY)
then the behavior is undefined. Historic versions of SQLite
have silently ignored surplus bits in the flags parameter to
sqlite3\_open\_v2(), however that behavior might not be carried through
into future versions of SQLite and so applications should not rely
upon it. Note in particular that the SQLITE\_OPEN\_EXCLUSIVE flag is a no\-op
for sqlite3\_open\_v2(). The SQLITE\_OPEN\_EXCLUSIVE does \*not\* cause
the open to fail if the database already exists. The SQLITE\_OPEN\_EXCLUSIVE
flag is intended for use by the [VFS interface](#sqlite3_vfs) only, and not
by sqlite3\_open\_v2().


The fourth parameter to sqlite3\_open\_v2() is the name of the
[sqlite3\_vfs](#sqlite3_vfs) object that defines the operating system interface that
the new database connection should use. If the fourth parameter is
a NULL pointer then the default [sqlite3\_vfs](#sqlite3_vfs) object is used.


If the filename is ":memory:", then a private, temporary in\-memory database
is created for the connection. This in\-memory database will vanish when
the database connection is closed. Future versions of SQLite might
make use of additional special filenames that begin with the ":" character.
It is recommended that when a database filename actually does begin with
a ":" character you should prefix the filename with a pathname such as
"./" to avoid ambiguity.


If the filename is an empty string, then a private, temporary
on\-disk database will be created. This private database will be
automatically deleted as soon as the database connection is closed.



