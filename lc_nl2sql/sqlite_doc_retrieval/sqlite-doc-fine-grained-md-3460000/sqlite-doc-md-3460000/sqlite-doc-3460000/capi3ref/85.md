## Change The EXPLAIN Setting For A Prepared Statement




> ```
> 
> int sqlite3_stmt_explain(sqlite3_stmt *pStmt, int eMode);
> 
> ```



The sqlite3\_stmt\_explain(S,E) interface changes the EXPLAIN
setting for [prepared statement](#sqlite3_stmt) S. If E is zero, then S becomes
a normal prepared statement. If E is 1, then S behaves as if
its SQL text began with "[EXPLAIN](lang_explain.html)". If E is 2, then S behaves as if
its SQL text began with "[EXPLAIN QUERY PLAN](eqp.html)".


Calling sqlite3\_stmt\_explain(S,E) might cause S to be reprepared.
SQLite tries to avoid a reprepare, but a reprepare might be necessary
on the first transition into EXPLAIN or EXPLAIN QUERY PLAN mode.


Because of the potential need to reprepare, a call to
sqlite3\_stmt\_explain(S,E) will fail with SQLITE\_ERROR if S cannot be
reprepared because it was created using [sqlite3\_prepare()](#sqlite3_prepare) instead of
the newer [sqlite3\_prepare\_v2()](#sqlite3_prepare) or [sqlite3\_prepare\_v3()](#sqlite3_prepare) interfaces and
hence has no saved SQL text with which to reprepare.


Changing the explain setting for a prepared statement does not change
the original SQL text for the statement. Hence, if the SQL text originally
began with EXPLAIN or EXPLAIN QUERY PLAN, but sqlite3\_stmt\_explain(S,0\)
is called to convert the statement into an ordinary statement, the EXPLAIN
or EXPLAIN QUERY PLAN keywords will still appear in the sqlite3\_sql(S)
output, even though the statement now acts like a normal SQL statement.


This routine returns SQLITE\_OK if the explain mode is successfully
changed, or an error code if the explain mode could not be changed.
The explain mode cannot be changed while a statement is active.
Hence, it is good practice to call [sqlite3\_reset(S)](#sqlite3_reset)
immediately prior to calling sqlite3\_stmt\_explain(S,E).




---


