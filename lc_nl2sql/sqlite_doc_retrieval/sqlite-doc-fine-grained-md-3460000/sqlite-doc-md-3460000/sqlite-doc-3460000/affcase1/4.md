## Limitations Of The OpenDocument Presentation Format



The use of a ZIP archive to encapsulate XML files plus resources is an
elegant approach to an application file format.
It is clearly superior to a custom binary file format.
But using an SQLite database as the
container, instead of ZIP, would be more elegant still.

A ZIP archive is basically a key/value database, optimized for
the case of write\-once/read\-many and for a relatively small number
of distinct keys (a few hundred to a few thousand) each with a large BLOB
as its value. A ZIP archive can be viewed as a "pile\-of\-files"
database. This works, but it has some shortcomings relative to an
SQLite database, as follows:

1. **Incremental update is hard.**

It is difficult to update individual entries in a ZIP archive.
It is especially difficult to update individual entries in a ZIP
archive in a way that does not destroy
the entire document if the computer loses power and/or crashes
in the middle of the update. It is not impossible to do this, but
it is sufficiently difficult that nobody actually does it. Instead, whenever
the user selects "File/Save", the entire ZIP archive is rewritten. 
Hence, "File/Save" takes longer than it ought, especially on
older hardware. Newer machines are faster, but it is still bothersome
that changing a single character in a 50 megabyte presentation causes one
to burn through 50 megabytes of the finite write life on the SSD.

- **Startup is slow.**

In keeping with the pile\-of\-files theme, OpenDocument stores all slide 
content in a single big XML file named "content.xml". 
LibreOffice reads and parses this entire file just to display
the first slide.
LibreOffice also seems to
read all images into memory as well, which makes sense seeing as when
the user does "File/Save" it is going to have to write them all back out
again, even though none of them changed. The net effect is that
start\-up is slow. Double\-clicking an OpenDocument file brings up a
progress bar rather than the first slide.
This results in a bad user experience.
The situation grows ever more annoying as
the document size increases.

- **More memory is required.**

Because ZIP archives are optimized for storing big chunks of content, they
encourage a style of programming where the entire document is read into
memory at startup, all editing occurs in memory, then the entire document
is written to disk during "File/Save". OpenOffice and its descendants
embrace that pattern.


One might argue that it is ok, in this era of multi\-gigabyte desktops, to
read the entire document into memory.
But it is not ok.
For one, the amount of memory used far exceeds the (compressed) file size
on disk. So a 50MB presentation might take 200MB or more RAM. 
That still is not a problem if one only edits a single document at a time. 
But when working on a talk, this author will typically have 10 or 15 different 
presentations up all at the same
time (to facilitate copy/paste of slides from past presentation) and so
gigabytes of memory are required.
Add in an open web browser or two and a few other 
desktop apps, and suddenly the disk is whirling and the machine is swapping.
And even having just a single document is a problem when working
on an inexpensive Chromebook retrofitted with Ubuntu.
Using less memory is always better.



- **Crash recovery is difficult.**

The descendants of OpenOffice tend to segfault more often than commercial
competitors. Perhaps for this reason, the OpenOffice forks make
periodic backups of their in\-memory documents so that users do not lose
all pending edits when the inevitable application crash does occur.
This causes frustrating pauses in the application for the few seconds
while each backup is being made.
After restarting from a crash, the user is presented with a dialog box
that walks them through the recovery process. Managing the crash
recovery this way involves lots of extra application logic and is
generally an annoyance to the user.

- **Content is inaccessible.**

One cannot easily view, change, or extract the content of an 
OpenDocument presentation using generic tools.
The only reasonable way to view or edit an OpenDocument document is to open
it up using an application that is specifically designed to read or write
OpenDocument (read: LibreOffice or one of its cousins). The situation
could be worse. One can extract and view individual images (say) from
a presentation using just the "zip" archiver tool. But it is not reasonable
try to extract the text from a slide. Remember that all content is stored
in a single "context.xml" file. That file is XML, so it is a text file.
But it is not a text file that can be managed with an ordinary text
editor. For the example presentation above, the content.xml file
consist of exactly two lines. The first line of the file is just:


> ```
> 
> <?xml version="1.0" encoding="UTF-8"?>
> 
> ```


The second line of the file contains 211792 characters of
impenetrable XML. Yes, 211792 characters all on one line.
This file is a good stress\-test for a text editor.
Thankfully, the file is not some obscure
binary format, but in terms of accessibility, it might as well be
written in Klingon.


