## 5\.2\.  The Super\-Journal File


![](images/ac/multi-1.gif)
The next step in a multi\-file commit is the creation of a
"super\-journal" file. The name of the super\-journal file is
the same name as the original database filename (the database
that was opened using the
[sqlite3\_open()](c3ref/open.html) interface,
not one of the [ATTACHed](lang_attach.html) auxiliary
databases) with the text "**\-mj***HHHHHHHH*" appended where
*HHHHHHHH* is a random 32\-bit hexadecimal number. The
random *HHHHHHHH* suffix changes for every new super\-journal.


*(Nota bene: The formula for computing the super\-journal filename
given in the previous paragraph corresponds to the implementation as
of SQLite version 3\.5\.0\. But this formula is not part of the SQLite
specification and is subject to change in future releases.)*


Unlike the rollback journals, the super\-journal does not contain
any original database page content. Instead, the super\-journal contains
the full pathnames for rollback journals for every database that is
participating in the transaction.


After the super\-journal is constructed, its content is flushed
to disk before any further actions are taken. On Unix, the directory
that contains the super\-journal is also synced in order to make sure
the super\-journal file will appear in the directory following a
power failure.


The purpose of the super\-journal is to ensure that multi\-file
transactions are atomic across a power\-loss. But if the database files
have other settings that compromise integrity across a power\-loss event
(such as [PRAGMA synchronous\=OFF](pragma.html#pragma_synchronous) or [PRAGMA journal\_mode\=MEMORY](pragma.html#pragma_journal_mode)) then
the creation of the super\-journal is omitted, as an optimization.

  




