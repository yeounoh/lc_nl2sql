## 3\.5\.  Creating A Rollback Journal File


![](images/ac/commit-4.gif)
Prior to making any changes to the database file, SQLite first
creates a separate rollback journal file and writes into the
rollback journal the original
content of the database pages that are to be altered.
The idea behind the rollback journal is that it contains
all information needed to restore the database back to
its original state.


The rollback journal contains a small header (shown in green
in the diagram) that records the original size of the database
file. So if a change causes the database file to grow, we
will still know the original size of the database. The page
number is stored together with each database page that is
written into the rollback journal.



 When a new file is created, most desktop operating systems
 (Windows, Linux, Mac OS X) will not actually write anything to
 disk. The new file is created in the operating systems disk
 cache only. The file is not created on mass storage until sometime
 later, when the operating system has a spare moment. This creates
 the impression to users that I/O is happening much faster than
 is possible when doing real disk I/O. We illustrate this idea in
 the diagram to the right by showing that the new rollback journal
 appears in the operating system disk cache only and not on the
 disk itself.


  


