### 2013\-03\-18 (3\.7\.16\)

1. Added the [PRAGMA foreign\_key\_check](pragma.html#pragma_foreign_key_check) command.
- Added new extended error codes for all SQLITE\_CONSTRAINT errors
- Added the SQLITE\_READONLY\_ROLLBACK extended error code for when a database
 cannot be opened because it needs rollback recovery but is read\-only.
- Added SQL functions [unicode(A)](lang_corefunc.html#unicode) and [char(X1,...,XN)](lang_corefunc.html#char).
- Performance improvements for [PRAGMA incremental\_vacuum](pragma.html#pragma_incremental_vacuum), especially in
 cases where the number of free pages is greater than what will fit on a
 single trunk page of the freelist.
- Improved optimization of queries containing aggregate min() or max().
- Enhance virtual tables so that they can potentially use an index when
 the WHERE clause contains the IN operator.
- Allow indices to be used for sorting even if prior terms of the index
 are constrained by IN operators in the WHERE clause.
- Enhance the [PRAGMA table\_info](pragma.html#pragma_table_info) command so that the "pk" column is an
 increasing integer to show the order of columns in the primary key.
- Enhance the query optimizer to exploit transitive join constraints.
- Performance improvements in the query optimizer.
- Allow the error message from [PRAGMA integrity\_check](pragma.html#pragma_integrity_check) to be longer than
 20000 bytes.
- Improved name resolution for deeply nested queries.
- Added the test\_regexp.c module as a demonstration of how to implement
 the REGEXP operator.
- Improved error messages in the [RTREE](rtree.html) extension.
- Enhance the [command\-line shell](cli.html) so that a non\-zero argument to the
 ".exit" command causes the shell to exit immediately without cleanly
 shutting down the database connection.
- Improved error messages for invalid boolean arguments to dot\-commands
 in the [command\-line shell](cli.html).
- Improved error messages for "foreign key mismatch" showing the names of
 the two tables involved.
- Remove all uses of umask() in the unix VFS.
- Added the [PRAGMA vdbe\_addoptrace](pragma.html#pragma_vdbe_addoptrace) and [PRAGMA vdbe\_debug](pragma.html#pragma_vdbe_debug) commands.
- Change to use strncmp() or the equivalent instead of memcmp() when
 comparing non\-zero\-terminated strings.
- Update cygwin interfaces to omit deprecated API calls.
- Enhance the [spellfix1](spellfix1.html) extension so that the edit distance cost table can
 be changed at runtime by inserting a string like 'edit\_cost\_table\=TABLE'
 into the "command" field.

- Bug fix: repair a long\-standing problem that could cause incorrect query
 results in a 3\-way or larger join that compared INTEGER fields against TEXT
 fields in two or more places.
 Ticket [fc7bd6358f](https://www.sqlite.org/src/info/fc7bd6358f)- Bug fix: Issue an error message if the 16\-bit reference counter on a
 view overflows due to an overly complex query.
- Bug fix: Avoid leaking memory on LIMIT and OFFSET clauses in deeply
 nested UNION ALL queries.
- Bug fix: Make sure the schema is up\-to\-date prior to running pragmas
 table\_info, index\_list, index\_info, and foreign\_key\_list.

- SQLITE\_SOURCE\_ID:
 "2013\-03\-18 11:39:23 66d5f2b76750f3520eb7a495f6247206758f5b90"
- SHA1 for sqlite3\.c: 7308ab891ca1b2ebc596025cfe4dc36f1ee89cf6




