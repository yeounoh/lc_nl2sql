### 2021\-03\-12 (3\.35\.0\)

1. Added [built\-in SQL math functions()](lang_mathfunc.html). (Requires the
 [\-DSQLITE\_ENABLE\_MATH\_FUNCTIONS](compile.html#enable_math_functions) compile\-time option.)
- Added support for [ALTER TABLE DROP COLUMN](lang_altertable.html#altertabdropcol).
- Generalize [UPSERT](lang_upsert.html):
	1. Allow multiple ON CONFLICT clauses that are evaluated in order,
	 - The final ON CONFLICT clause may omit the conflict target and
	 yet still use DO UPDATE.- Add support for the [RETURNING](lang_returning.html) clause on [DELETE](lang_delete.html), [INSERT](lang_insert.html), and
 [UPDATE](lang_update.html) statements.
- Use less memory when running [VACUUM](lang_vacuum.html) on databases containing very large
 TEXT or BLOB values. It is no longer necessary to hold the entire TEXT
 or BLOB in memory all at once.
- Add support for the [MATERIALIZED](lang_with.html#mathint) and [NOT MATERIALIZED](lang_with.html#mathint) hints when
 specifying [common table expressions](lang_with.html). The default behavior was
 formerly NOT MATERIALIZED, but is now changed to MATERIALIZED for
 CTEs that are used more than once.
- The [SQLITE\_DBCONFIG\_ENABLE\_TRIGGER](c3ref/c_dbconfig_defensive.html#sqlitedbconfigenabletrigger) and [SQLITE\_DBCONFIG\_ENABLE\_VIEW](c3ref/c_dbconfig_defensive.html#sqlitedbconfigenableview)
 settings are modified so that they only control triggers and views
 in the main database schema or in attached database schemas and not in
 the TEMP schema. TEMP triggers and views are always allowed.
- Query planner/optimizer improvements:
	1. Enhancements to the [min/max optimization](optoverview.html#minmax) so that it works better
	 with the IN operator and the OP\_SeekScan optimization of the
	 previous release.
	 - Attempt to process EXISTS operators in the WHERE clause as if
	 they were IN operators, in cases where this is a valid transformation
	 and seems likely to improve performance.
	 - Allow UNION ALL sub\-queries to be [flattened](optoverview.html#flattening) even if the parent query is a join.
	 - Use an index, if appropriate, on IS NOT NULL expressions in the WHERE clause,
	 even if STAT4 is disabled.
	 - Expressions of the form "x IS NULL" or "x IS NOT NULL" might be converted to simply
	 FALSE or TRUE, if "x" is a column that has a "NOT NULL" constraint and is not
	 involved in an outer join.
	 - Avoid checking foreign key constraints on an UPDATE statement if the UPDATE does
	 not modify any columns associated with the foreign key.
	 - Allow WHERE terms to be [pushed down](optoverview.html#pushdown) into sub\-queries
	 that contain window functions,
	 as long as the WHERE term is made up of entirely of constants and copies of expressions
	 found in the PARTITION BY clauses of all window functions in the sub\-query.- [CLI](cli.html) enhancements:
	1. Enhance the ".stats" command to accept new arguments "stmt" and
	 "vmstep", causing prepare statement statistics and only the
	 virtual\-machine step count to be shown, respectively.
	 - Add the ".filectrl data\_version" command.
	 - Enhance the ".once" and ".output" commands so that if the destination argument
	 begins with "\|" (indicating that output is redirected into a pipe) then the
	 argument does not need to be quoted.- Bug fixes:
	1. Fix a potential NULL pointer dereference when processing a
	 syntactically incorrect SELECT statement with a correlated WHERE
	 clause and a "HAVING 0" clause. (Also fixed in the 3\.34\.1 patch release.)
	 - Fix a [bug in the IN\-operator optimization](https://www.sqlite.org/src/info/ee51301f316c09e9)
	 of version 3\.33\.0 that can cause an incorrect answer.
	 - Fix incorrect answers from the [LIKE operator](lang_expr.html#like) if the pattern ends with "%" and there
	 is an "ESCAPE '\_'" clause.**Hashes:**
- SQLITE\_SOURCE\_ID: 2021\-03\-12 15:10:09 acd63062eb06748bfe9e4886639e4f2b54ea6a496a83f10716abbaba4115500b
- SHA3\-256 for sqlite3\.c: 73a740d881735bef9de7f7bce8c9e6b9e57fe3e77fa7d76a6e8fc5c262fbaedf




