## 4\.14\. The json\_patch() function


The json\_patch(T,P) SQL function runs the
[RFC\-7396](https://tools.ietf.org/html/rfc7396) MergePatch algorithm
to apply patch P against input T. The patched copy of T is returned.



MergePatch can add, modify, or delete elements of a JSON Object,
and so for JSON Objects, the json\_patch() routine is a generalized
replacement for [json\_set()](json1.html#jset) and [json\_remove()](json1.html#jrm). However, MergePatch
treats JSON Array objects as atomic. MergePatch cannot append to an
Array nor modify individual elements of an Array. It can only insert,
replace, or delete the whole Array as a single unit. Hence, json\_patch()
is not as useful when dealing with JSON that includes Arrays,
especially Arrays with lots of substructure.



Examples:

* json\_patch('{"a":1,"b":2}','{"c":3,"d":4}')
→ '{"a":1,"b":2,"c":3,"d":4}'
* json\_patch('{"a":\[1,2],"b":2}','{"a":9}')
→ '{"a":9,"b":2}'
* json\_patch('{"a":\[1,2],"b":2}','{"a":null}')
→ '{"b":2}'
* json\_patch('{"a":1,"b":2}','{"a":9,"b":null,"c":8}')
→ '{"a":9,"c":8}'
* json\_patch('{"a":{"x":1,"y":2},"b":3}','{"a":{"y":9},"c":8}')
→ '{"a":{"x":1,"y":9},"b":3,"c":8}'





