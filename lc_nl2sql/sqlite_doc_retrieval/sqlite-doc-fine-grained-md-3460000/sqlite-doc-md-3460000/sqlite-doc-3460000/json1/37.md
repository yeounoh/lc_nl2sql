## 4\.23\. The json\_each() and json\_tree() table\-valued functions


The json\_each(X) and json\_tree(X) [table\-valued functions](vtab.html#tabfunc2) walk the
JSON value provided as their first argument and return one row for each
element. The json\_each(X) function only walks the immediate children
of the top\-level array or object,
or just the top\-level element itself if the top\-level
element is a primitive value.
The json\_tree(X) function recursively walks through the
JSON substructure starting with the top\-level element. 



The json\_each(X,P) and json\_tree(X,P) functions work just like
their one\-argument counterparts except that they treat the element
identified by path P as the top\-level element.



The schema for the table returned by json\_each() and json\_tree() is
as follows:




> ```
> 
> CREATE TABLE json_tree(
>     key ANY,             -- key for current element relative to its parent
>     value ANY,           -- value for the current element
>     type TEXT,           -- 'object','array','string','integer', etc.
>     atom ANY,            -- value for primitive types, null for array & object
>     id INTEGER,          -- integer ID for this element
>     parent INTEGER,      -- integer ID for the parent of this element
>     fullkey TEXT,        -- full path describing the current element
>     path TEXT,           -- path to the container of the current row
>     json JSON HIDDEN,    -- 1st input parameter: the raw JSON
>     root TEXT HIDDEN     -- 2nd input parameter: the PATH at which to start
> );
> 
> ```



The "key" column is the integer array index for elements of a JSON array 
and the text label for elements of a JSON object. The key column is
NULL in all other cases.




The "atom" column is the SQL value corresponding to primitive elements \- 
elements other than JSON arrays and objects. The "atom" column is NULL
for a JSON array or object. The "value" column is the same as the
"atom" column for primitive JSON elements but takes on the text JSON value
for arrays and objects.




The "type" column is an SQL text value taken from ('null', 'true', 'false',
'integer', 'real', 'text', 'array', 'object') according to the type of
the current JSON element.




The "id" column is an integer that identifies a specific JSON element
within the complete JSON string. The "id" integer is an internal housekeeping
number, the computation of which might change in future releases. The
only guarantee is that the "id" column will be different for every row.




The "parent" column is always NULL for json\_each().
For json\_tree(),
the "parent" column is the "id" integer for the parent of the current
element, or NULL for the top\-level JSON element or the element identified
by the root path in the second argument.




The "fullkey" column is a text path that uniquely identifies the current
row element within the original JSON string. The complete key to the
true top\-level element is returned even if an alternative starting point
is provided by the "root" argument.




The "path" column is the path to the array or object container that holds 
the current row, or the path to the current row in the case where the 
iteration starts on a primitive type and thus only provides a single
row of output.



